{"version":3,"file":"defined-names.js","names":["_typeof","obj","Symbol","iterator","constructor","prototype","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","_toPropertyKey","key","_createClass","protoProps","staticProps","arg","_toPrimitive","String","input","hint","prim","toPrimitive","undefined","res","call","Number","_","require","colCache","CellMatrix","Range","rangeRegexp","DefinedNames","matrixMap","value","getMatrix","name","matrix","add","locStr","location","decodeEx","addEx","top","col","left","right","row","bottom","address","sheetName","n2l","addCellEx","remove","removeEx","removeCellEx","removeAllNames","each","forEach","callback","cell","getNames","addressStr","getNamesEx","map","findCellEx","filter","Boolean","_explore","mark","range","x","y","vGrow","yy","edge","c","findCellAt","hGrow","xx","cells","push","getRanges","_this","ranges","$shortRange","normaliseMatrix","forEachInSheet","spliceRows","start","numDelete","numInsert","_this2","spliceColumns","_this3","get","_this4","definedName","set","rangeStr","test","split","pop","addCell","module","exports"],"sources":["../../../lib/doc/defined-names.js"],"sourcesContent":["'use strict';\r\n\r\nconst _ = require('../utils/under-dash');\r\nconst colCache = require('../utils/col-cache');\r\nconst CellMatrix = require('../utils/cell-matrix');\r\nconst Range = require('./range');\r\n\r\nconst rangeRegexp = /[$](\\w+)[$](\\d+)(:[$](\\w+)[$](\\d+))?/;\r\n\r\nclass DefinedNames {\r\n  constructor() {\r\n    this.matrixMap = {};\r\n  }\r\n\r\n  getMatrix(name) {\r\n    const matrix = this.matrixMap[name] || (this.matrixMap[name] = new CellMatrix());\r\n    return matrix;\r\n  }\r\n\r\n  // add a name to a cell. locStr in the form SheetName!$col$row or SheetName!$c1$r1:$c2:$r2\r\n  add(locStr, name) {\r\n    const location = colCache.decodeEx(locStr);\r\n    this.addEx(location, name);\r\n  }\r\n\r\n  addEx(location, name) {\r\n    const matrix = this.getMatrix(name);\r\n    if (location.top) {\r\n      for (let col = location.left; col <= location.right; col++) {\r\n        for (let row = location.top; row <= location.bottom; row++) {\r\n          const address = {\r\n            sheetName: location.sheetName,\r\n            address: colCache.n2l(col) + row,\r\n            row,\r\n            col,\r\n          };\r\n\r\n          matrix.addCellEx(address);\r\n        }\r\n      }\r\n    } else {\r\n      matrix.addCellEx(location);\r\n    }\r\n  }\r\n\r\n  remove(locStr, name) {\r\n    const location = colCache.decodeEx(locStr);\r\n    this.removeEx(location, name);\r\n  }\r\n\r\n  removeEx(location, name) {\r\n    const matrix = this.getMatrix(name);\r\n    matrix.removeCellEx(location);\r\n  }\r\n\r\n  removeAllNames(location) {\r\n    _.each(this.matrixMap, matrix => {\r\n      matrix.removeCellEx(location);\r\n    });\r\n  }\r\n\r\n  forEach(callback) {\r\n    _.each(this.matrixMap, (matrix, name) => {\r\n      matrix.forEach(cell => {\r\n        callback(name, cell);\r\n      });\r\n    });\r\n  }\r\n\r\n  // get all the names of a cell\r\n  getNames(addressStr) {\r\n    return this.getNamesEx(colCache.decodeEx(addressStr));\r\n  }\r\n\r\n  getNamesEx(address) {\r\n    return _.map(this.matrixMap, (matrix, name) => matrix.findCellEx(address) && name).filter(\r\n      Boolean\r\n    );\r\n  }\r\n\r\n  _explore(matrix, cell) {\r\n    cell.mark = false;\r\n    const {sheetName} = cell;\r\n\r\n    const range = new Range(cell.row, cell.col, cell.row, cell.col, sheetName);\r\n    let x;\r\n    let y;\r\n\r\n    // grow vertical - only one col to worry about\r\n    function vGrow(yy, edge) {\r\n      const c = matrix.findCellAt(sheetName, yy, cell.col);\r\n      if (!c || !c.mark) {\r\n        return false;\r\n      }\r\n      range[edge] = yy;\r\n      c.mark = false;\r\n      return true;\r\n    }\r\n    for (y = cell.row - 1; vGrow(y, 'top'); y--);\r\n    for (y = cell.row + 1; vGrow(y, 'bottom'); y++);\r\n\r\n    // grow horizontal - ensure all rows can grow\r\n    function hGrow(xx, edge) {\r\n      const cells = [];\r\n      for (y = range.top; y <= range.bottom; y++) {\r\n        const c = matrix.findCellAt(sheetName, y, xx);\r\n        if (c && c.mark) {\r\n          cells.push(c);\r\n        } else {\r\n          return false;\r\n        }\r\n      }\r\n      range[edge] = xx;\r\n      for (let i = 0; i < cells.length; i++) {\r\n        cells[i].mark = false;\r\n      }\r\n      return true;\r\n    }\r\n    for (x = cell.col - 1; hGrow(x, 'left'); x--);\r\n    for (x = cell.col + 1; hGrow(x, 'right'); x++);\r\n\r\n    return range;\r\n  }\r\n\r\n  getRanges(name, matrix) {\r\n    matrix = matrix || this.matrixMap[name];\r\n\r\n    if (!matrix) {\r\n      return {name, ranges: []};\r\n    }\r\n\r\n    // mark and sweep!\r\n    matrix.forEach(cell => {\r\n      cell.mark = true;\r\n    });\r\n    const ranges = matrix\r\n      .map(cell => cell.mark && this._explore(matrix, cell))\r\n      .filter(Boolean)\r\n      .map(range => range.$shortRange);\r\n\r\n    return {\r\n      name,\r\n      ranges,\r\n    };\r\n  }\r\n\r\n  normaliseMatrix(matrix, sheetName) {\r\n    // some of the cells might have shifted on specified sheet\r\n    // need to reassign rows, cols\r\n    matrix.forEachInSheet(sheetName, (cell, row, col) => {\r\n      if (cell) {\r\n        if (cell.row !== row || cell.col !== col) {\r\n          cell.row = row;\r\n          cell.col = col;\r\n          cell.address = colCache.n2l(col) + row;\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  spliceRows(sheetName, start, numDelete, numInsert) {\r\n    _.each(this.matrixMap, matrix => {\r\n      matrix.spliceRows(sheetName, start, numDelete, numInsert);\r\n      this.normaliseMatrix(matrix, sheetName);\r\n    });\r\n  }\r\n\r\n  spliceColumns(sheetName, start, numDelete, numInsert) {\r\n    _.each(this.matrixMap, matrix => {\r\n      matrix.spliceColumns(sheetName, start, numDelete, numInsert);\r\n      this.normaliseMatrix(matrix, sheetName);\r\n    });\r\n  }\r\n\r\n  get model() {\r\n    // To get names per cell - just iterate over all names finding cells if they exist\r\n    return _.map(this.matrixMap, (matrix, name) => this.getRanges(name, matrix)).filter(\r\n      definedName => definedName.ranges.length\r\n    );\r\n  }\r\n\r\n  set model(value) {\r\n    // value is [ { name, ranges }, ... ]\r\n    const matrixMap = (this.matrixMap = {});\r\n    value.forEach(definedName => {\r\n      const matrix = (matrixMap[definedName.name] = new CellMatrix());\r\n      definedName.ranges.forEach(rangeStr => {\r\n        if (rangeRegexp.test(rangeStr.split('!').pop() || '')) {\r\n          matrix.addCell(rangeStr);\r\n        }\r\n      });\r\n    });\r\n  }\r\n}\r\n\r\nmodule.exports = DefinedNames;\r\n"],"mappings":"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"}