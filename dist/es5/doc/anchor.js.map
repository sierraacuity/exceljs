{"version":3,"file":"anchor.js","names":["_typeof","obj","Symbol","iterator","constructor","prototype","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","_toPropertyKey","key","_createClass","protoProps","staticProps","arg","_toPrimitive","String","input","hint","prim","toPrimitive","undefined","res","call","Number","colCache","require","Anchor","worksheet","address","offset","arguments","nativeCol","nativeColOff","nativeRow","nativeRowOff","decoded","decodeAddress","col","row","get","Math","min","colWidth","set","v","floor","rowHeight","getColumn","isCustomWidth","width","getRow","height","value","asInstance","model","module","exports"],"sources":["../../../lib/doc/anchor.js"],"sourcesContent":["'use strict';\r\n\r\nconst colCache = require('../utils/col-cache');\r\n\r\nclass Anchor {\r\n  constructor(worksheet, address, offset = 0) {\r\n    this.worksheet = worksheet;\r\n\r\n    if (!address) {\r\n      this.nativeCol = 0;\r\n      this.nativeColOff = 0;\r\n      this.nativeRow = 0;\r\n      this.nativeRowOff = 0;\r\n    } else if (typeof address === 'string') {\r\n      const decoded = colCache.decodeAddress(address);\r\n      this.nativeCol = decoded.col + offset;\r\n      this.nativeColOff = 0;\r\n      this.nativeRow = decoded.row + offset;\r\n      this.nativeRowOff = 0;\r\n    } else if (address.nativeCol !== undefined) {\r\n      this.nativeCol = address.nativeCol || 0;\r\n      this.nativeColOff = address.nativeColOff || 0;\r\n      this.nativeRow = address.nativeRow || 0;\r\n      this.nativeRowOff = address.nativeRowOff || 0;\r\n    } else if (address.col !== undefined) {\r\n      this.col = address.col + offset;\r\n      this.row = address.row + offset;\r\n    } else {\r\n      this.nativeCol = 0;\r\n      this.nativeColOff = 0;\r\n      this.nativeRow = 0;\r\n      this.nativeRowOff = 0;\r\n    }\r\n  }\r\n\r\n  static asInstance(model) {\r\n    return model instanceof Anchor || model == null ? model : new Anchor(model);\r\n  }\r\n\r\n  get col() {\r\n    return this.nativeCol + (Math.min(this.colWidth - 1, this.nativeColOff) / this.colWidth);\r\n  }\r\n\r\n  set col(v) {\r\n    this.nativeCol = Math.floor(v);\r\n    this.nativeColOff = Math.floor((v - this.nativeCol) * this.colWidth);\r\n  }\r\n\r\n  get row() {\r\n    return this.nativeRow + (Math.min(this.rowHeight - 1, this.nativeRowOff) / this.rowHeight);\r\n  }\r\n\r\n  set row(v) {\r\n    this.nativeRow = Math.floor(v);\r\n    this.nativeRowOff = Math.floor((v - this.nativeRow) * this.rowHeight);\r\n  }\r\n\r\n  get colWidth() {\r\n    return this.worksheet &&\r\n      this.worksheet.getColumn(this.nativeCol + 1) &&\r\n      this.worksheet.getColumn(this.nativeCol + 1).isCustomWidth\r\n      ? Math.floor(this.worksheet.getColumn(this.nativeCol + 1).width * 10000)\r\n      : 640000;\r\n  }\r\n\r\n  get rowHeight() {\r\n    return this.worksheet &&\r\n      this.worksheet.getRow(this.nativeRow + 1) &&\r\n      this.worksheet.getRow(this.nativeRow + 1).height\r\n      ? Math.floor(this.worksheet.getRow(this.nativeRow + 1).height * 10000)\r\n      : 180000;\r\n  }\r\n\r\n  get model() {\r\n    return {\r\n      nativeCol: this.nativeCol,\r\n      nativeColOff: this.nativeColOff,\r\n      nativeRow: this.nativeRow,\r\n      nativeRowOff: this.nativeRowOff,\r\n    };\r\n  }\r\n\r\n  set model(value) {\r\n    this.nativeCol = value.nativeCol;\r\n    this.nativeColOff = value.nativeColOff;\r\n    this.nativeRow = value.nativeRow;\r\n    this.nativeRowOff = value.nativeRowOff;\r\n  }\r\n}\r\n\r\nmodule.exports = Anchor;\r\n"],"mappings":"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"}