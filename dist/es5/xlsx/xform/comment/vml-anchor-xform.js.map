{"version":3,"file":"vml-anchor-xform.js","names":["BaseXform","require","VmlAnchorXform","_BaseXform","_inherits","_super","_createSuper","_classCallCheck","apply","arguments","_createClass","key","get","value","getAnchorRect","anchor","l","Math","floor","left","lf","t","top","tf","r","right","rf","b","bottom","bf","getDefaultRect","ref","col","max","row","render","xmlStream","model","rect","refAddress","leafNode","join","parseOpen","node","name","tag","text","parseText","parseClose","module","exports"],"sources":["../../../../../lib/xlsx/xform/comment/vml-anchor-xform.js"],"sourcesContent":["const BaseXform = require('../base-xform');\r\n\r\n// render the triangle in the cell for the comment\r\nclass VmlAnchorXform extends BaseXform {\r\n  get tag() {\r\n    return 'x:Anchor';\r\n  }\r\n\r\n  getAnchorRect(anchor) {\r\n    const l = Math.floor(anchor.left);\r\n    const lf = Math.floor((anchor.left - l) * 68);\r\n    const t = Math.floor(anchor.top);\r\n    const tf = Math.floor((anchor.top - t) * 18);\r\n    const r = Math.floor(anchor.right);\r\n    const rf = Math.floor((anchor.right - r) * 68);\r\n    const b = Math.floor(anchor.bottom);\r\n    const bf = Math.floor((anchor.bottom - b) * 18);\r\n    return [l, lf, t, tf, r, rf, b, bf];\r\n  }\r\n\r\n  getDefaultRect(ref) {\r\n    const l = ref.col;\r\n    const lf = 6;\r\n    const t = Math.max(ref.row - 2, 0);\r\n    const tf = 14;\r\n    const r = l + 2;\r\n    const rf = 2;\r\n    const b = t + 4;\r\n    const bf = 16;\r\n    return [l, lf, t, tf, r, rf, b, bf];\r\n  }\r\n\r\n  render(xmlStream, model) {\r\n    const rect = model.anchor\r\n      ? this.getAnchorRect(model.anchor)\r\n      : this.getDefaultRect(model.refAddress);\r\n\r\n    xmlStream.leafNode('x:Anchor', null, rect.join(', '));\r\n  }\r\n\r\n  parseOpen(node) {\r\n    switch (node.name) {\r\n      case this.tag:\r\n        this.text = '';\r\n        return true;\r\n      default:\r\n        return false;\r\n    }\r\n  }\r\n\r\n  parseText(text) {\r\n    this.text = text;\r\n  }\r\n\r\n  parseClose() {\r\n    return false;\r\n  }\r\n}\r\n\r\nmodule.exports = VmlAnchorXform;\r\n"],"mappings":"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"}