{"version":3,"file":"app-xform.js","names":["XmlStream","require","BaseXform","StringXform","AppHeadingPairsXform","AppTitleOfPartsXform","AppXform","_BaseXform","_inherits","_super","_createSuper","_this","_classCallCheck","call","map","Company","tag","Manager","HeadingPairs","TitleOfParts","_createClass","key","value","render","xmlStream","model","openXml","StdDocAttributes","openNode","PROPERTY_ATTRIBUTES","leafNode","undefined","worksheets","company","manager","closeNode","parseOpen","node","parser","name","parseText","text","parseClose","DateFormat","dt","toISOString","replace","DateAttrs","xmlns","module","exports"],"sources":["../../../../../lib/xlsx/xform/core/app-xform.js"],"sourcesContent":["const XmlStream = require('../../../utils/xml-stream');\r\nconst BaseXform = require('../base-xform');\r\nconst StringXform = require('../simple/string-xform');\r\n\r\nconst AppHeadingPairsXform = require('./app-heading-pairs-xform');\r\nconst AppTitleOfPartsXform = require('./app-titles-of-parts-xform');\r\n\r\nclass AppXform extends BaseXform {\r\n  constructor() {\r\n    super();\r\n\r\n    this.map = {\r\n      Company: new StringXform({tag: 'Company'}),\r\n      Manager: new StringXform({tag: 'Manager'}),\r\n      HeadingPairs: new AppHeadingPairsXform(),\r\n      TitleOfParts: new AppTitleOfPartsXform(),\r\n    };\r\n  }\r\n\r\n  render(xmlStream, model) {\r\n    xmlStream.openXml(XmlStream.StdDocAttributes);\r\n\r\n    xmlStream.openNode('Properties', AppXform.PROPERTY_ATTRIBUTES);\r\n\r\n    xmlStream.leafNode('Application', undefined, 'Microsoft Excel');\r\n    xmlStream.leafNode('DocSecurity', undefined, '0');\r\n    xmlStream.leafNode('ScaleCrop', undefined, 'false');\r\n\r\n    this.map.HeadingPairs.render(xmlStream, model.worksheets);\r\n    this.map.TitleOfParts.render(xmlStream, model.worksheets);\r\n    this.map.Company.render(xmlStream, model.company || '');\r\n    this.map.Manager.render(xmlStream, model.manager);\r\n\r\n    xmlStream.leafNode('LinksUpToDate', undefined, 'false');\r\n    xmlStream.leafNode('SharedDoc', undefined, 'false');\r\n    xmlStream.leafNode('HyperlinksChanged', undefined, 'false');\r\n    xmlStream.leafNode('AppVersion', undefined, '16.0300');\r\n\r\n    xmlStream.closeNode();\r\n  }\r\n\r\n  parseOpen(node) {\r\n    if (this.parser) {\r\n      this.parser.parseOpen(node);\r\n      return true;\r\n    }\r\n    switch (node.name) {\r\n      case 'Properties':\r\n        return true;\r\n      default:\r\n        this.parser = this.map[node.name];\r\n        if (this.parser) {\r\n          this.parser.parseOpen(node);\r\n          return true;\r\n        }\r\n\r\n        // there's a lot we don't bother to parse\r\n        return false;\r\n    }\r\n  }\r\n\r\n  parseText(text) {\r\n    if (this.parser) {\r\n      this.parser.parseText(text);\r\n    }\r\n  }\r\n\r\n  parseClose(name) {\r\n    if (this.parser) {\r\n      if (!this.parser.parseClose(name)) {\r\n        this.parser = undefined;\r\n      }\r\n      return true;\r\n    }\r\n    switch (name) {\r\n      case 'Properties':\r\n        this.model = {\r\n          worksheets: this.map.TitleOfParts.model,\r\n          company: this.map.Company.model,\r\n          manager: this.map.Manager.model,\r\n        };\r\n        return false;\r\n      default:\r\n        return true;\r\n    }\r\n  }\r\n}\r\n\r\nAppXform.DateFormat = function(dt) {\r\n  return dt.toISOString().replace(/[.]\\d{3,6}/, '');\r\n};\r\n\r\nAppXform.DateAttrs = {'xsi:type': 'dcterms:W3CDTF'};\r\n\r\nAppXform.PROPERTY_ATTRIBUTES = {\r\n  xmlns: 'http://schemas.openxmlformats.org/officeDocument/2006/extended-properties',\r\n  'xmlns:vt': 'http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes',\r\n};\r\n\r\nmodule.exports = AppXform;\r\n"],"mappings":"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"}