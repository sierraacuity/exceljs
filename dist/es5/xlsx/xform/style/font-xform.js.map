{"version":3,"file":"font-xform.js","names":["_typeof","obj","Symbol","iterator","constructor","prototype","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","_toPropertyKey","key","_createClass","protoProps","staticProps","arg","_toPrimitive","String","input","hint","prim","toPrimitive","undefined","res","call","Number","_inherits","subClass","superClass","create","value","_setPrototypeOf","o","p","setPrototypeOf","bind","__proto__","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","_getPrototypeOf","result","NewTarget","Reflect","construct","arguments","apply","_possibleConstructorReturn","self","_assertThisInitialized","ReferenceError","sham","Proxy","Boolean","valueOf","e","getPrototypeOf","ColorXform","require","BooleanXform","IntegerXform","StringXform","UnderlineXform","_","BaseXform","FontXform","_BaseXform","_super","options","_this","OPTIONS","map","b","prop","xform","tag","attr","u","charset","color","condense","extend","family","outline","vertAlign","scheme","shadow","strike","sz","fontNameTag","get","tagName","render","xmlStream","model","openNode","each","defn","closeNode","parseOpen","node","parser","name","parseText","text","parseClose","item","module","exports"],"sources":["../../../../../lib/xlsx/xform/style/font-xform.js"],"sourcesContent":["'use strict';\r\n\r\nconst ColorXform = require('./color-xform');\r\nconst BooleanXform = require('../simple/boolean-xform');\r\nconst IntegerXform = require('../simple/integer-xform');\r\nconst StringXform = require('../simple/string-xform');\r\nconst UnderlineXform = require('./underline-xform');\r\n\r\nconst _ = require('../../../utils/under-dash');\r\nconst BaseXform = require('../base-xform');\r\n\r\n// Font encapsulates translation from font model to xlsx\r\nclass FontXform extends BaseXform {\r\n  constructor(options) {\r\n    super();\r\n\r\n    this.options = options || FontXform.OPTIONS;\r\n\r\n    this.map = {\r\n      b: {prop: 'bold', xform: new BooleanXform({tag: 'b', attr: 'val'})},\r\n      i: {prop: 'italic', xform: new BooleanXform({tag: 'i', attr: 'val'})},\r\n      u: {prop: 'underline', xform: new UnderlineXform()},\r\n      charset: {prop: 'charset', xform: new IntegerXform({tag: 'charset', attr: 'val'})},\r\n      color: {prop: 'color', xform: new ColorXform()},\r\n      condense: {prop: 'condense', xform: new BooleanXform({tag: 'condense', attr: 'val'})},\r\n      extend: {prop: 'extend', xform: new BooleanXform({tag: 'extend', attr: 'val'})},\r\n      family: {prop: 'family', xform: new IntegerXform({tag: 'family', attr: 'val'})},\r\n      outline: {prop: 'outline', xform: new BooleanXform({tag: 'outline', attr: 'val'})},\r\n      vertAlign: {prop: 'vertAlign', xform: new StringXform({tag: 'vertAlign', attr: 'val'})},\r\n      scheme: {prop: 'scheme', xform: new StringXform({tag: 'scheme', attr: 'val'})},\r\n      shadow: {prop: 'shadow', xform: new BooleanXform({tag: 'shadow', attr: 'val'})},\r\n      strike: {prop: 'strike', xform: new BooleanXform({tag: 'strike', attr: 'val'})},\r\n      sz: {prop: 'size', xform: new IntegerXform({tag: 'sz', attr: 'val'})},\r\n    };\r\n    this.map[this.options.fontNameTag] = {\r\n      prop: 'name',\r\n      xform: new StringXform({tag: this.options.fontNameTag, attr: 'val'}),\r\n    };\r\n  }\r\n\r\n  get tag() {\r\n    return this.options.tagName;\r\n  }\r\n\r\n  render(xmlStream, model) {\r\n    const {map} = this;\r\n\r\n    xmlStream.openNode(this.options.tagName);\r\n    _.each(this.map, (defn, tag) => {\r\n      map[tag].xform.render(xmlStream, model[defn.prop]);\r\n    });\r\n    xmlStream.closeNode();\r\n  }\r\n\r\n  parseOpen(node) {\r\n    if (this.parser) {\r\n      this.parser.parseOpen(node);\r\n      return true;\r\n    }\r\n    if (this.map[node.name]) {\r\n      this.parser = this.map[node.name].xform;\r\n      return this.parser.parseOpen(node);\r\n    }\r\n    switch (node.name) {\r\n      case this.options.tagName:\r\n        this.model = {};\r\n        return true;\r\n      default:\r\n        return false;\r\n    }\r\n  }\r\n\r\n  parseText(text) {\r\n    if (this.parser) {\r\n      this.parser.parseText(text);\r\n    }\r\n  }\r\n\r\n  parseClose(name) {\r\n    if (this.parser && !this.parser.parseClose(name)) {\r\n      const item = this.map[name];\r\n      if (this.parser.model) {\r\n        this.model[item.prop] = this.parser.model;\r\n      }\r\n      this.parser = undefined;\r\n      return true;\r\n    }\r\n    switch (name) {\r\n      case this.options.tagName:\r\n        return false;\r\n      default:\r\n        return true;\r\n    }\r\n  }\r\n}\r\n\r\nFontXform.OPTIONS = {\r\n  tagName: 'font',\r\n  fontNameTag: 'name',\r\n};\r\n\r\nmodule.exports = FontXform;\r\n"],"mappings":"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"}