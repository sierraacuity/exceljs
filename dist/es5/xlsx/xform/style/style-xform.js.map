{"version":3,"file":"style-xform.js","names":["BaseXform","require","AlignmentXform","ProtectionXform","StyleXform","_BaseXform","_inherits","_super","_createSuper","options","_this","_classCallCheck","call","xfId","map","alignment","protection","_createClass","key","get","value","render","xmlStream","model","openNode","numFmtId","fontId","fillId","borderId","addAttribute","closeNode","parseOpen","node","parser","name","parseInt","attributes","parseText","text","parseClose","undefined","module","exports"],"sources":["../../../../../lib/xlsx/xform/style/style-xform.js"],"sourcesContent":["const BaseXform = require('../base-xform');\r\n\r\nconst AlignmentXform = require('./alignment-xform');\r\nconst ProtectionXform = require('./protection-xform');\r\n\r\n// <xf numFmtId=\"[numFmtId]\" fontId=\"[fontId]\" fillId=\"[fillId]\" borderId=\"[xf.borderId]\" xfId=\"[xfId]\">\r\n//   Optional <alignment>\r\n//   Optional <protection>\r\n// </xf>\r\n\r\n// Style assists translation from style model to/from xlsx\r\nclass StyleXform extends BaseXform {\r\n  constructor(options) {\r\n    super();\r\n\r\n    this.xfId = !!(options && options.xfId);\r\n    this.map = {\r\n      alignment: new AlignmentXform(),\r\n      protection: new ProtectionXform(),\r\n    };\r\n  }\r\n\r\n  get tag() {\r\n    return 'xf';\r\n  }\r\n\r\n  render(xmlStream, model) {\r\n    xmlStream.openNode('xf', {\r\n      numFmtId: model.numFmtId || 0,\r\n      fontId: model.fontId || 0,\r\n      fillId: model.fillId || 0,\r\n      borderId: model.borderId || 0,\r\n    });\r\n    if (this.xfId) {\r\n      xmlStream.addAttribute('xfId', model.xfId || 0);\r\n    }\r\n\r\n    if (model.numFmtId) {\r\n      xmlStream.addAttribute('applyNumberFormat', '1');\r\n    }\r\n    if (model.fontId) {\r\n      xmlStream.addAttribute('applyFont', '1');\r\n    }\r\n    if (model.fillId) {\r\n      xmlStream.addAttribute('applyFill', '1');\r\n    }\r\n    if (model.borderId) {\r\n      xmlStream.addAttribute('applyBorder', '1');\r\n    }\r\n    if (model.alignment) {\r\n      xmlStream.addAttribute('applyAlignment', '1');\r\n    }\r\n    if (model.protection) {\r\n      xmlStream.addAttribute('applyProtection', '1');\r\n    }\r\n\r\n    /**\r\n     * Rendering tags causes close of XML stream.\r\n     * Therefore adding attributes must be done before rendering tags.\r\n     */\r\n\r\n    if (model.alignment) {\r\n      this.map.alignment.render(xmlStream, model.alignment);\r\n    }\r\n    if (model.protection) {\r\n      this.map.protection.render(xmlStream, model.protection);\r\n    }\r\n\r\n    xmlStream.closeNode();\r\n  }\r\n\r\n  parseOpen(node) {\r\n    if (this.parser) {\r\n      this.parser.parseOpen(node);\r\n      return true;\r\n    }\r\n    // used during sax parsing of xml to build font object\r\n    switch (node.name) {\r\n      case 'xf':\r\n        this.model = {\r\n          numFmtId: parseInt(node.attributes.numFmtId, 10),\r\n          fontId: parseInt(node.attributes.fontId, 10),\r\n          fillId: parseInt(node.attributes.fillId, 10),\r\n          borderId: parseInt(node.attributes.borderId, 10),\r\n        };\r\n        if (this.xfId) {\r\n          this.model.xfId = parseInt(node.attributes.xfId, 10);\r\n        }\r\n        return true;\r\n      case 'alignment':\r\n        this.parser = this.map.alignment;\r\n        this.parser.parseOpen(node);\r\n        return true;\r\n      case 'protection':\r\n        this.parser = this.map.protection;\r\n        this.parser.parseOpen(node);\r\n        return true;\r\n      default:\r\n        return false;\r\n    }\r\n  }\r\n\r\n  parseText(text) {\r\n    if (this.parser) {\r\n      this.parser.parseText(text);\r\n    }\r\n  }\r\n\r\n  parseClose(name) {\r\n    if (this.parser) {\r\n      if (!this.parser.parseClose(name)) {\r\n        if (this.map.protection === this.parser) {\r\n          this.model.protection = this.parser.model;\r\n        } else {\r\n          this.model.alignment = this.parser.model;\r\n        }\r\n        this.parser = undefined;\r\n      }\r\n      return true;\r\n    }\r\n    return name !== 'xf';\r\n  }\r\n}\r\n\r\nmodule.exports = StyleXform;\r\n"],"mappings":";;;;;;;;;;;;;;;AAAA,IAAMA,SAAS,GAAGC,OAAO,CAAC,eAAe,CAAC;AAE1C,IAAMC,cAAc,GAAGD,OAAO,CAAC,mBAAmB,CAAC;AACnD,IAAME,eAAe,GAAGF,OAAO,CAAC,oBAAoB,CAAC;;AAErD;AACA;AACA;AACA;;AAEA;AAAA,IACMG,UAAU,0BAAAC,UAAA;EAAAC,SAAA,CAAAF,UAAA,EAAAC,UAAA;EAAA,IAAAE,MAAA,GAAAC,YAAA,CAAAJ,UAAA;EACd,SAAAA,WAAYK,OAAO,EAAE;IAAA,IAAAC,KAAA;IAAAC,eAAA,OAAAP,UAAA;IACnBM,KAAA,GAAAH,MAAA,CAAAK,IAAA;IAEAF,KAAA,CAAKG,IAAI,GAAG,CAAC,EAAEJ,OAAO,IAAIA,OAAO,CAACI,IAAI,CAAC;IACvCH,KAAA,CAAKI,GAAG,GAAG;MACTC,SAAS,EAAE,IAAIb,cAAc,CAAC,CAAC;MAC/Bc,UAAU,EAAE,IAAIb,eAAe,CAAC;IAClC,CAAC;IAAC,OAAAO,KAAA;EACJ;EAACO,YAAA,CAAAb,UAAA;IAAAc,GAAA;IAAAC,GAAA,EAED,SAAAA,IAAA,EAAU;MACR,OAAO,IAAI;IACb;EAAC;IAAAD,GAAA;IAAAE,KAAA,EAED,SAAAC,OAAOC,SAAS,EAAEC,KAAK,EAAE;MACvBD,SAAS,CAACE,QAAQ,CAAC,IAAI,EAAE;QACvBC,QAAQ,EAAEF,KAAK,CAACE,QAAQ,IAAI,CAAC;QAC7BC,MAAM,EAAEH,KAAK,CAACG,MAAM,IAAI,CAAC;QACzBC,MAAM,EAAEJ,KAAK,CAACI,MAAM,IAAI,CAAC;QACzBC,QAAQ,EAAEL,KAAK,CAACK,QAAQ,IAAI;MAC9B,CAAC,CAAC;MACF,IAAI,IAAI,CAACf,IAAI,EAAE;QACbS,SAAS,CAACO,YAAY,CAAC,MAAM,EAAEN,KAAK,CAACV,IAAI,IAAI,CAAC,CAAC;MACjD;MAEA,IAAIU,KAAK,CAACE,QAAQ,EAAE;QAClBH,SAAS,CAACO,YAAY,CAAC,mBAAmB,EAAE,GAAG,CAAC;MAClD;MACA,IAAIN,KAAK,CAACG,MAAM,EAAE;QAChBJ,SAAS,CAACO,YAAY,CAAC,WAAW,EAAE,GAAG,CAAC;MAC1C;MACA,IAAIN,KAAK,CAACI,MAAM,EAAE;QAChBL,SAAS,CAACO,YAAY,CAAC,WAAW,EAAE,GAAG,CAAC;MAC1C;MACA,IAAIN,KAAK,CAACK,QAAQ,EAAE;QAClBN,SAAS,CAACO,YAAY,CAAC,aAAa,EAAE,GAAG,CAAC;MAC5C;MACA,IAAIN,KAAK,CAACR,SAAS,EAAE;QACnBO,SAAS,CAACO,YAAY,CAAC,gBAAgB,EAAE,GAAG,CAAC;MAC/C;MACA,IAAIN,KAAK,CAACP,UAAU,EAAE;QACpBM,SAAS,CAACO,YAAY,CAAC,iBAAiB,EAAE,GAAG,CAAC;MAChD;;MAEA;AACJ;AACA;AACA;;MAEI,IAAIN,KAAK,CAACR,SAAS,EAAE;QACnB,IAAI,CAACD,GAAG,CAACC,SAAS,CAACM,MAAM,CAACC,SAAS,EAAEC,KAAK,CAACR,SAAS,CAAC;MACvD;MACA,IAAIQ,KAAK,CAACP,UAAU,EAAE;QACpB,IAAI,CAACF,GAAG,CAACE,UAAU,CAACK,MAAM,CAACC,SAAS,EAAEC,KAAK,CAACP,UAAU,CAAC;MACzD;MAEAM,SAAS,CAACQ,SAAS,CAAC,CAAC;IACvB;EAAC;IAAAZ,GAAA;IAAAE,KAAA,EAED,SAAAW,UAAUC,IAAI,EAAE;MACd,IAAI,IAAI,CAACC,MAAM,EAAE;QACf,IAAI,CAACA,MAAM,CAACF,SAAS,CAACC,IAAI,CAAC;QAC3B,OAAO,IAAI;MACb;MACA;MACA,QAAQA,IAAI,CAACE,IAAI;QACf,KAAK,IAAI;UACP,IAAI,CAACX,KAAK,GAAG;YACXE,QAAQ,EAAEU,QAAQ,CAACH,IAAI,CAACI,UAAU,CAACX,QAAQ,EAAE,EAAE,CAAC;YAChDC,MAAM,EAAES,QAAQ,CAACH,IAAI,CAACI,UAAU,CAACV,MAAM,EAAE,EAAE,CAAC;YAC5CC,MAAM,EAAEQ,QAAQ,CAACH,IAAI,CAACI,UAAU,CAACT,MAAM,EAAE,EAAE,CAAC;YAC5CC,QAAQ,EAAEO,QAAQ,CAACH,IAAI,CAACI,UAAU,CAACR,QAAQ,EAAE,EAAE;UACjD,CAAC;UACD,IAAI,IAAI,CAACf,IAAI,EAAE;YACb,IAAI,CAACU,KAAK,CAACV,IAAI,GAAGsB,QAAQ,CAACH,IAAI,CAACI,UAAU,CAACvB,IAAI,EAAE,EAAE,CAAC;UACtD;UACA,OAAO,IAAI;QACb,KAAK,WAAW;UACd,IAAI,CAACoB,MAAM,GAAG,IAAI,CAACnB,GAAG,CAACC,SAAS;UAChC,IAAI,CAACkB,MAAM,CAACF,SAAS,CAACC,IAAI,CAAC;UAC3B,OAAO,IAAI;QACb,KAAK,YAAY;UACf,IAAI,CAACC,MAAM,GAAG,IAAI,CAACnB,GAAG,CAACE,UAAU;UACjC,IAAI,CAACiB,MAAM,CAACF,SAAS,CAACC,IAAI,CAAC;UAC3B,OAAO,IAAI;QACb;UACE,OAAO,KAAK;MAChB;IACF;EAAC;IAAAd,GAAA;IAAAE,KAAA,EAED,SAAAiB,UAAUC,IAAI,EAAE;MACd,IAAI,IAAI,CAACL,MAAM,EAAE;QACf,IAAI,CAACA,MAAM,CAACI,SAAS,CAACC,IAAI,CAAC;MAC7B;IACF;EAAC;IAAApB,GAAA;IAAAE,KAAA,EAED,SAAAmB,WAAWL,IAAI,EAAE;MACf,IAAI,IAAI,CAACD,MAAM,EAAE;QACf,IAAI,CAAC,IAAI,CAACA,MAAM,CAACM,UAAU,CAACL,IAAI,CAAC,EAAE;UACjC,IAAI,IAAI,CAACpB,GAAG,CAACE,UAAU,KAAK,IAAI,CAACiB,MAAM,EAAE;YACvC,IAAI,CAACV,KAAK,CAACP,UAAU,GAAG,IAAI,CAACiB,MAAM,CAACV,KAAK;UAC3C,CAAC,MAAM;YACL,IAAI,CAACA,KAAK,CAACR,SAAS,GAAG,IAAI,CAACkB,MAAM,CAACV,KAAK;UAC1C;UACA,IAAI,CAACU,MAAM,GAAGO,SAAS;QACzB;QACA,OAAO,IAAI;MACb;MACA,OAAON,IAAI,KAAK,IAAI;IACtB;EAAC;EAAA,OAAA9B,UAAA;AAAA,EA9GsBJ,SAAS;AAiHlCyC,MAAM,CAACC,OAAO,GAAGtC,UAAU"}