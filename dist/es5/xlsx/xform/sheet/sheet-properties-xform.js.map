{"version":3,"file":"sheet-properties-xform.js","names":["BaseXform","require","ColorXform","PageSetupPropertiesXform","OutlinePropertiesXform","SheetPropertiesXform","_BaseXform","_inherits","_super","_createSuper","_this","_classCallCheck","call","map","tabColor","pageSetUpPr","outlinePr","_createClass","key","get","value","render","xmlStream","model","addRollback","openNode","inner","pageSetup","outlineProperties","closeNode","commit","rollback","parseOpen","node","parser","name","tag","reset","parseText","text","parseClose","undefined","module","exports"],"sources":["../../../../../lib/xlsx/xform/sheet/sheet-properties-xform.js"],"sourcesContent":["const BaseXform = require('../base-xform');\r\nconst ColorXform = require('../style/color-xform');\r\nconst PageSetupPropertiesXform = require('./page-setup-properties-xform');\r\nconst OutlinePropertiesXform = require('./outline-properties-xform');\r\n\r\nclass SheetPropertiesXform extends BaseXform {\r\n  constructor() {\r\n    super();\r\n\r\n    this.map = {\r\n      tabColor: new ColorXform('tabColor'),\r\n      pageSetUpPr: new PageSetupPropertiesXform(),\r\n      outlinePr: new OutlinePropertiesXform(),\r\n    };\r\n  }\r\n\r\n  get tag() {\r\n    return 'sheetPr';\r\n  }\r\n\r\n  render(xmlStream, model) {\r\n    if (model) {\r\n      xmlStream.addRollback();\r\n      xmlStream.openNode('sheetPr');\r\n\r\n      let inner = false;\r\n      inner = this.map.tabColor.render(xmlStream, model.tabColor) || inner;\r\n      inner = this.map.pageSetUpPr.render(xmlStream, model.pageSetup) || inner;\r\n      inner = this.map.outlinePr.render(xmlStream, model.outlineProperties) || inner;\r\n\r\n      if (inner) {\r\n        xmlStream.closeNode();\r\n        xmlStream.commit();\r\n      } else {\r\n        xmlStream.rollback();\r\n      }\r\n    }\r\n  }\r\n\r\n  parseOpen(node) {\r\n    if (this.parser) {\r\n      this.parser.parseOpen(node);\r\n      return true;\r\n    }\r\n    if (node.name === this.tag) {\r\n      this.reset();\r\n      return true;\r\n    }\r\n    if (this.map[node.name]) {\r\n      this.parser = this.map[node.name];\r\n      this.parser.parseOpen(node);\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  parseText(text) {\r\n    if (this.parser) {\r\n      this.parser.parseText(text);\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  parseClose(name) {\r\n    if (this.parser) {\r\n      if (!this.parser.parseClose(name)) {\r\n        this.parser = undefined;\r\n      }\r\n      return true;\r\n    }\r\n    if (this.map.tabColor.model || this.map.pageSetUpPr.model || this.map.outlinePr.model) {\r\n      this.model = {};\r\n      if (this.map.tabColor.model) {\r\n        this.model.tabColor = this.map.tabColor.model;\r\n      }\r\n      if (this.map.pageSetUpPr.model) {\r\n        this.model.pageSetup = this.map.pageSetUpPr.model;\r\n      }\r\n      if (this.map.outlinePr.model) {\r\n        this.model.outlineProperties = this.map.outlinePr.model;\r\n      }\r\n    } else {\r\n      this.model = null;\r\n    }\r\n    return false;\r\n  }\r\n}\r\n\r\nmodule.exports = SheetPropertiesXform;\r\n"],"mappings":";;;;;;;;;;;;;;;AAAA,IAAMA,SAAS,GAAGC,OAAO,CAAC,eAAe,CAAC;AAC1C,IAAMC,UAAU,GAAGD,OAAO,CAAC,sBAAsB,CAAC;AAClD,IAAME,wBAAwB,GAAGF,OAAO,CAAC,+BAA+B,CAAC;AACzE,IAAMG,sBAAsB,GAAGH,OAAO,CAAC,4BAA4B,CAAC;AAAC,IAE/DI,oBAAoB,0BAAAC,UAAA;EAAAC,SAAA,CAAAF,oBAAA,EAAAC,UAAA;EAAA,IAAAE,MAAA,GAAAC,YAAA,CAAAJ,oBAAA;EACxB,SAAAA,qBAAA,EAAc;IAAA,IAAAK,KAAA;IAAAC,eAAA,OAAAN,oBAAA;IACZK,KAAA,GAAAF,MAAA,CAAAI,IAAA;IAEAF,KAAA,CAAKG,GAAG,GAAG;MACTC,QAAQ,EAAE,IAAIZ,UAAU,CAAC,UAAU,CAAC;MACpCa,WAAW,EAAE,IAAIZ,wBAAwB,CAAC,CAAC;MAC3Ca,SAAS,EAAE,IAAIZ,sBAAsB,CAAC;IACxC,CAAC;IAAC,OAAAM,KAAA;EACJ;EAACO,YAAA,CAAAZ,oBAAA;IAAAa,GAAA;IAAAC,GAAA,EAED,SAAAA,IAAA,EAAU;MACR,OAAO,SAAS;IAClB;EAAC;IAAAD,GAAA;IAAAE,KAAA,EAED,SAAAC,OAAOC,SAAS,EAAEC,KAAK,EAAE;MACvB,IAAIA,KAAK,EAAE;QACTD,SAAS,CAACE,WAAW,CAAC,CAAC;QACvBF,SAAS,CAACG,QAAQ,CAAC,SAAS,CAAC;QAE7B,IAAIC,KAAK,GAAG,KAAK;QACjBA,KAAK,GAAG,IAAI,CAACb,GAAG,CAACC,QAAQ,CAACO,MAAM,CAACC,SAAS,EAAEC,KAAK,CAACT,QAAQ,CAAC,IAAIY,KAAK;QACpEA,KAAK,GAAG,IAAI,CAACb,GAAG,CAACE,WAAW,CAACM,MAAM,CAACC,SAAS,EAAEC,KAAK,CAACI,SAAS,CAAC,IAAID,KAAK;QACxEA,KAAK,GAAG,IAAI,CAACb,GAAG,CAACG,SAAS,CAACK,MAAM,CAACC,SAAS,EAAEC,KAAK,CAACK,iBAAiB,CAAC,IAAIF,KAAK;QAE9E,IAAIA,KAAK,EAAE;UACTJ,SAAS,CAACO,SAAS,CAAC,CAAC;UACrBP,SAAS,CAACQ,MAAM,CAAC,CAAC;QACpB,CAAC,MAAM;UACLR,SAAS,CAACS,QAAQ,CAAC,CAAC;QACtB;MACF;IACF;EAAC;IAAAb,GAAA;IAAAE,KAAA,EAED,SAAAY,UAAUC,IAAI,EAAE;MACd,IAAI,IAAI,CAACC,MAAM,EAAE;QACf,IAAI,CAACA,MAAM,CAACF,SAAS,CAACC,IAAI,CAAC;QAC3B,OAAO,IAAI;MACb;MACA,IAAIA,IAAI,CAACE,IAAI,KAAK,IAAI,CAACC,GAAG,EAAE;QAC1B,IAAI,CAACC,KAAK,CAAC,CAAC;QACZ,OAAO,IAAI;MACb;MACA,IAAI,IAAI,CAACxB,GAAG,CAACoB,IAAI,CAACE,IAAI,CAAC,EAAE;QACvB,IAAI,CAACD,MAAM,GAAG,IAAI,CAACrB,GAAG,CAACoB,IAAI,CAACE,IAAI,CAAC;QACjC,IAAI,CAACD,MAAM,CAACF,SAAS,CAACC,IAAI,CAAC;QAC3B,OAAO,IAAI;MACb;MACA,OAAO,KAAK;IACd;EAAC;IAAAf,GAAA;IAAAE,KAAA,EAED,SAAAkB,UAAUC,IAAI,EAAE;MACd,IAAI,IAAI,CAACL,MAAM,EAAE;QACf,IAAI,CAACA,MAAM,CAACI,SAAS,CAACC,IAAI,CAAC;QAC3B,OAAO,IAAI;MACb;MACA,OAAO,KAAK;IACd;EAAC;IAAArB,GAAA;IAAAE,KAAA,EAED,SAAAoB,WAAWL,IAAI,EAAE;MACf,IAAI,IAAI,CAACD,MAAM,EAAE;QACf,IAAI,CAAC,IAAI,CAACA,MAAM,CAACM,UAAU,CAACL,IAAI,CAAC,EAAE;UACjC,IAAI,CAACD,MAAM,GAAGO,SAAS;QACzB;QACA,OAAO,IAAI;MACb;MACA,IAAI,IAAI,CAAC5B,GAAG,CAACC,QAAQ,CAACS,KAAK,IAAI,IAAI,CAACV,GAAG,CAACE,WAAW,CAACQ,KAAK,IAAI,IAAI,CAACV,GAAG,CAACG,SAAS,CAACO,KAAK,EAAE;QACrF,IAAI,CAACA,KAAK,GAAG,CAAC,CAAC;QACf,IAAI,IAAI,CAACV,GAAG,CAACC,QAAQ,CAACS,KAAK,EAAE;UAC3B,IAAI,CAACA,KAAK,CAACT,QAAQ,GAAG,IAAI,CAACD,GAAG,CAACC,QAAQ,CAACS,KAAK;QAC/C;QACA,IAAI,IAAI,CAACV,GAAG,CAACE,WAAW,CAACQ,KAAK,EAAE;UAC9B,IAAI,CAACA,KAAK,CAACI,SAAS,GAAG,IAAI,CAACd,GAAG,CAACE,WAAW,CAACQ,KAAK;QACnD;QACA,IAAI,IAAI,CAACV,GAAG,CAACG,SAAS,CAACO,KAAK,EAAE;UAC5B,IAAI,CAACA,KAAK,CAACK,iBAAiB,GAAG,IAAI,CAACf,GAAG,CAACG,SAAS,CAACO,KAAK;QACzD;MACF,CAAC,MAAM;QACL,IAAI,CAACA,KAAK,GAAG,IAAI;MACnB;MACA,OAAO,KAAK;IACd;EAAC;EAAA,OAAAlB,oBAAA;AAAA,EAjFgCL,SAAS;AAoF5C0C,MAAM,CAACC,OAAO,GAAGtC,oBAAoB"}