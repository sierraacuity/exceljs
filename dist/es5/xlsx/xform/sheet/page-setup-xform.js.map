{"version":3,"file":"page-setup-xform.js","names":["_","require","BaseXform","booleanToXml","model","undefined","pageOrderToXml","cellCommentsToXml","errorsToXml","pageSizeToModel","value","parseInt","PageSetupXform","_BaseXform","_inherits","_super","_createSuper","_classCallCheck","apply","arguments","_createClass","key","get","render","xmlStream","attributes","paperSize","orientation","horizontalDpi","verticalDpi","pageOrder","blackAndWhite","draft","cellComments","errors","scale","fitToWidth","fitToHeight","firstPageNumber","useFirstPageNumber","usePrinterDefaults","copies","some","leafNode","tag","parseOpen","node","name","parseText","parseClose","module","exports"],"sources":["../../../../../lib/xlsx/xform/sheet/page-setup-xform.js"],"sourcesContent":["const _ = require('../../../utils/under-dash');\r\nconst BaseXform = require('../base-xform');\r\n\r\nfunction booleanToXml(model) {\r\n  return model ? '1' : undefined;\r\n}\r\nfunction pageOrderToXml(model) {\r\n  switch (model) {\r\n    case 'overThenDown':\r\n      return model;\r\n    default:\r\n      return undefined;\r\n  }\r\n}\r\nfunction cellCommentsToXml(model) {\r\n  switch (model) {\r\n    case 'atEnd':\r\n    case 'asDisplyed':\r\n      return model;\r\n    default:\r\n      return undefined;\r\n  }\r\n}\r\nfunction errorsToXml(model) {\r\n  switch (model) {\r\n    case 'dash':\r\n    case 'blank':\r\n    case 'NA':\r\n      return model;\r\n    default:\r\n      return undefined;\r\n  }\r\n}\r\nfunction pageSizeToModel(value) {\r\n  return value !== undefined ? parseInt(value, 10) : undefined;\r\n}\r\n\r\nclass PageSetupXform extends BaseXform {\r\n  get tag() {\r\n    return 'pageSetup';\r\n  }\r\n\r\n  render(xmlStream, model) {\r\n    if (model) {\r\n      const attributes = {\r\n        paperSize: model.paperSize,\r\n        orientation: model.orientation,\r\n        horizontalDpi: model.horizontalDpi,\r\n        verticalDpi: model.verticalDpi,\r\n        pageOrder: pageOrderToXml(model.pageOrder),\r\n        blackAndWhite: booleanToXml(model.blackAndWhite),\r\n        draft: booleanToXml(model.draft),\r\n        cellComments: cellCommentsToXml(model.cellComments),\r\n        errors: errorsToXml(model.errors),\r\n        scale: model.scale,\r\n        fitToWidth: model.fitToWidth,\r\n        fitToHeight: model.fitToHeight,\r\n        firstPageNumber: model.firstPageNumber,\r\n        useFirstPageNumber: booleanToXml(model.firstPageNumber),\r\n        usePrinterDefaults: booleanToXml(model.usePrinterDefaults),\r\n        copies: model.copies,\r\n      };\r\n      if (_.some(attributes, value => value !== undefined)) {\r\n        xmlStream.leafNode(this.tag, attributes);\r\n      }\r\n    }\r\n  }\r\n\r\n  parseOpen(node) {\r\n    switch (node.name) {\r\n      case this.tag:\r\n        this.model = {\r\n          paperSize: pageSizeToModel(node.attributes.paperSize),\r\n          orientation: node.attributes.orientation || 'portrait',\r\n          horizontalDpi: parseInt(node.attributes.horizontalDpi || '4294967295', 10),\r\n          verticalDpi: parseInt(node.attributes.verticalDpi || '4294967295', 10),\r\n          pageOrder: node.attributes.pageOrder || 'downThenOver',\r\n          blackAndWhite: node.attributes.blackAndWhite === '1',\r\n          draft: node.attributes.draft === '1',\r\n          cellComments: node.attributes.cellComments || 'None',\r\n          errors: node.attributes.errors || 'displayed',\r\n          scale: parseInt(node.attributes.scale || '100', 10),\r\n          fitToWidth: parseInt(node.attributes.fitToWidth || '1', 10),\r\n          fitToHeight: parseInt(node.attributes.fitToHeight || '1', 10),\r\n          firstPageNumber: parseInt(node.attributes.firstPageNumber || '1', 10),\r\n          useFirstPageNumber: node.attributes.useFirstPageNumber === '1',\r\n          usePrinterDefaults: node.attributes.usePrinterDefaults === '1',\r\n          copies: parseInt(node.attributes.copies || '1', 10),\r\n        };\r\n        return true;\r\n      default:\r\n        return false;\r\n    }\r\n  }\r\n\r\n  parseText() {}\r\n\r\n  parseClose() {\r\n    return false;\r\n  }\r\n}\r\n\r\nmodule.exports = PageSetupXform;\r\n"],"mappings":"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"}