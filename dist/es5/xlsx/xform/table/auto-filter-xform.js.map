{"version":3,"file":"auto-filter-xform.js","names":["BaseXform","require","FilterColumnXform","AutoFilterXform","_BaseXform","_inherits","_super","_createSuper","_this","_classCallCheck","call","map","filterColumn","_createClass","key","get","value","prepare","model","_this2","columns","forEach","column","index","render","xmlStream","_this3","openNode","tag","ref","autoFilterRef","closeNode","parseOpen","node","parser","name","attributes","Error","concat","JSON","stringify","parseText","text","parseClose","push","undefined","module","exports"],"sources":["../../../../../lib/xlsx/xform/table/auto-filter-xform.js"],"sourcesContent":["const BaseXform = require('../base-xform');\r\n\r\nconst FilterColumnXform = require('./filter-column-xform');\r\n\r\nclass AutoFilterXform extends BaseXform {\r\n  constructor() {\r\n    super();\r\n\r\n    this.map = {\r\n      filterColumn: new FilterColumnXform(),\r\n    };\r\n  }\r\n\r\n  get tag() {\r\n    return 'autoFilter';\r\n  }\r\n\r\n  prepare(model) {\r\n    model.columns.forEach((column, index) => {\r\n      this.map.filterColumn.prepare(column, {index});\r\n    });\r\n  }\r\n\r\n  render(xmlStream, model) {\r\n    xmlStream.openNode(this.tag, {ref: model.autoFilterRef});\r\n\r\n    model.columns.forEach(column => {\r\n      this.map.filterColumn.render(xmlStream, column);\r\n    });\r\n\r\n    xmlStream.closeNode();\r\n    return true;\r\n  }\r\n\r\n  parseOpen(node) {\r\n    if (this.parser) {\r\n      this.parser.parseOpen(node);\r\n      return true;\r\n    }\r\n    switch (node.name) {\r\n      case this.tag:\r\n        this.model = {\r\n          autoFilterRef: node.attributes.ref,\r\n          columns: [],\r\n        };\r\n        return true;\r\n\r\n      default:\r\n        this.parser = this.map[node.name];\r\n        if (this.parser) {\r\n          this.parseOpen(node);\r\n          return true;\r\n        }\r\n        throw new Error(`Unexpected xml node in parseOpen: ${JSON.stringify(node)}`);\r\n    }\r\n  }\r\n\r\n  parseText(text) {\r\n    if (this.parser) {\r\n      this.parser.parseText(text);\r\n    }\r\n  }\r\n\r\n  parseClose(name) {\r\n    if (this.parser) {\r\n      if (!this.parser.parseClose(name)) {\r\n        this.model.columns.push(this.parser.model);\r\n        this.parser = undefined;\r\n      }\r\n      return true;\r\n    }\r\n    switch (name) {\r\n      case this.tag:\r\n        return false;\r\n      default:\r\n        throw new Error(`Unexpected xml node in parseClose: ${name}`);\r\n    }\r\n  }\r\n}\r\n\r\nmodule.exports = AutoFilterXform;\r\n"],"mappings":"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"}