{"version":3,"file":"copy-style.js","names":["oneDepthCopy","obj","nestKeys","_objectSpread","reduce","memo","key","setIfExists","src","dst","arguments","length","undefined","isEmptyObj","Object","keys","copyStyle","style","copied","border","fill","stops","map","s","exports"],"sources":["../../../lib/utils/copy-style.js"],"sourcesContent":["const oneDepthCopy = (obj, nestKeys) => ({\r\n  ...obj,\r\n  ...nestKeys.reduce((memo, key) => {\r\n    if (obj[key]) memo[key] = {...obj[key]};\r\n    return memo;\r\n  }, {}),\r\n});\r\n\r\nconst setIfExists = (src, dst, key, nestKeys = []) => {\r\n  if (src[key]) dst[key] = oneDepthCopy(src[key], nestKeys);\r\n};\r\n\r\nconst isEmptyObj = obj => Object.keys(obj).length === 0;\r\n\r\nconst copyStyle = style => {\r\n  if (!style) return style;\r\n  if (isEmptyObj(style)) return {};\r\n\r\n  const copied = {...style};\r\n\r\n  setIfExists(style, copied, 'font', ['color']);\r\n  setIfExists(style, copied, 'alignment');\r\n  setIfExists(style, copied, 'protection');\r\n  if (style.border) {\r\n    setIfExists(style, copied, 'border');\r\n    setIfExists(style.border, copied.border, 'top', ['color']);\r\n    setIfExists(style.border, copied.border, 'left', ['color']);\r\n    setIfExists(style.border, copied.border, 'bottom', ['color']);\r\n    setIfExists(style.border, copied.border, 'right', ['color']);\r\n    setIfExists(style.border, copied.border, 'diagonal', ['color']);\r\n  }\r\n\r\n  if (style.fill) {\r\n    setIfExists(style, copied, 'fill', ['fgColor', 'bgColor', 'center']);\r\n    if (style.fill.stops) {\r\n      copied.fill.stops = style.fill.stops.map(s => oneDepthCopy(s, ['color']));\r\n    }\r\n  }\r\n\r\n  return copied;\r\n};\r\n\r\nexports.copyStyle = copyStyle;\r\n"],"mappings":";;;;;;;;AAAA,IAAMA,YAAY,GAAG,SAAfA,YAAYA,CAAIC,GAAG,EAAEC,QAAQ;EAAA,OAAAC,aAAA,CAAAA,aAAA,KAC9BF,GAAG,GACHC,QAAQ,CAACE,MAAM,CAAC,UAACC,IAAI,EAAEC,GAAG,EAAK;IAChC,IAAIL,GAAG,CAACK,GAAG,CAAC,EAAED,IAAI,CAACC,GAAG,CAAC,GAAAH,aAAA,KAAOF,GAAG,CAACK,GAAG,CAAC,CAAC;IACvC,OAAOD,IAAI;EACb,CAAC,EAAE,CAAC,CAAC,CAAC;AAAA,CACN;AAEF,IAAME,WAAW,GAAG,SAAdA,WAAWA,CAAIC,GAAG,EAAEC,GAAG,EAAEH,GAAG,EAAoB;EAAA,IAAlBJ,QAAQ,GAAAQ,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAG,EAAE;EAC/C,IAAIF,GAAG,CAACF,GAAG,CAAC,EAAEG,GAAG,CAACH,GAAG,CAAC,GAAGN,YAAY,CAACQ,GAAG,CAACF,GAAG,CAAC,EAAEJ,QAAQ,CAAC;AAC3D,CAAC;AAED,IAAMW,UAAU,GAAG,SAAbA,UAAUA,CAAGZ,GAAG;EAAA,OAAIa,MAAM,CAACC,IAAI,CAACd,GAAG,CAAC,CAACU,MAAM,KAAK,CAAC;AAAA;AAEvD,IAAMK,SAAS,GAAG,SAAZA,SAASA,CAAGC,KAAK,EAAI;EACzB,IAAI,CAACA,KAAK,EAAE,OAAOA,KAAK;EACxB,IAAIJ,UAAU,CAACI,KAAK,CAAC,EAAE,OAAO,CAAC,CAAC;EAEhC,IAAMC,MAAM,GAAAf,aAAA,KAAOc,KAAK,CAAC;EAEzBV,WAAW,CAACU,KAAK,EAAEC,MAAM,EAAE,MAAM,EAAE,CAAC,OAAO,CAAC,CAAC;EAC7CX,WAAW,CAACU,KAAK,EAAEC,MAAM,EAAE,WAAW,CAAC;EACvCX,WAAW,CAACU,KAAK,EAAEC,MAAM,EAAE,YAAY,CAAC;EACxC,IAAID,KAAK,CAACE,MAAM,EAAE;IAChBZ,WAAW,CAACU,KAAK,EAAEC,MAAM,EAAE,QAAQ,CAAC;IACpCX,WAAW,CAACU,KAAK,CAACE,MAAM,EAAED,MAAM,CAACC,MAAM,EAAE,KAAK,EAAE,CAAC,OAAO,CAAC,CAAC;IAC1DZ,WAAW,CAACU,KAAK,CAACE,MAAM,EAAED,MAAM,CAACC,MAAM,EAAE,MAAM,EAAE,CAAC,OAAO,CAAC,CAAC;IAC3DZ,WAAW,CAACU,KAAK,CAACE,MAAM,EAAED,MAAM,CAACC,MAAM,EAAE,QAAQ,EAAE,CAAC,OAAO,CAAC,CAAC;IAC7DZ,WAAW,CAACU,KAAK,CAACE,MAAM,EAAED,MAAM,CAACC,MAAM,EAAE,OAAO,EAAE,CAAC,OAAO,CAAC,CAAC;IAC5DZ,WAAW,CAACU,KAAK,CAACE,MAAM,EAAED,MAAM,CAACC,MAAM,EAAE,UAAU,EAAE,CAAC,OAAO,CAAC,CAAC;EACjE;EAEA,IAAIF,KAAK,CAACG,IAAI,EAAE;IACdb,WAAW,CAACU,KAAK,EAAEC,MAAM,EAAE,MAAM,EAAE,CAAC,SAAS,EAAE,SAAS,EAAE,QAAQ,CAAC,CAAC;IACpE,IAAID,KAAK,CAACG,IAAI,CAACC,KAAK,EAAE;MACpBH,MAAM,CAACE,IAAI,CAACC,KAAK,GAAGJ,KAAK,CAACG,IAAI,CAACC,KAAK,CAACC,GAAG,CAAC,UAAAC,CAAC;QAAA,OAAIvB,YAAY,CAACuB,CAAC,EAAE,CAAC,OAAO,CAAC,CAAC;MAAA,EAAC;IAC3E;EACF;EAEA,OAAOL,MAAM;AACf,CAAC;AAEDM,OAAO,CAACR,SAAS,GAAGA,SAAS"}