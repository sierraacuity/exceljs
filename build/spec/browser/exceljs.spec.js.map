{"version":3,"file":"exceljs.spec.js","names":["unexpectedError","done","error","console","message","stack","expect","toEqual","describe","it","wb","ExcelJS","Workbook","ws","addWorksheet","getCell","value","xlsx","writeBuffer","then","buffer","wb2","load","ws2","getWorksheet","toBeTruthy","catch","options","base64","toString","csv"],"sources":["../../../spec/browser/exceljs.spec.js"],"sourcesContent":["/* global ExcelJS */\r\n// ExcelJS is a global injected by `./dist/exceljs.js` during jasmine's setup\r\n\r\n'use strict';\r\n\r\nfunction unexpectedError(done) {\r\n  return function(error) {\r\n    // eslint-disable-next-line no-console\r\n    console.error('Error Caught', error.message, error.stack);\r\n    expect(true).toEqual(false);\r\n    done();\r\n  };\r\n}\r\n\r\ndescribe('ExcelJS', () => {\r\n  it('should read and write xlsx via binary buffer', done => {\r\n    const wb = new ExcelJS.Workbook();\r\n    const ws = wb.addWorksheet('blort');\r\n\r\n    ws.getCell('A1').value = 'Hello, World!';\r\n    ws.getCell('A2').value = 7;\r\n\r\n    wb.xlsx\r\n      .writeBuffer()\r\n      .then(buffer => {\r\n        const wb2 = new ExcelJS.Workbook();\r\n        return wb2.xlsx.load(buffer).then(() => {\r\n          const ws2 = wb2.getWorksheet('blort');\r\n          expect(ws2).toBeTruthy();\r\n\r\n          expect(ws2.getCell('A1').value).toEqual('Hello, World!');\r\n          expect(ws2.getCell('A2').value).toEqual(7);\r\n          done();\r\n        });\r\n      })\r\n      .catch(error => {\r\n        throw error;\r\n      })\r\n      .catch(unexpectedError(done));\r\n  });\r\n  it('should read and write xlsx via base64 buffer', done => {\r\n    const options = {\r\n      base64: true,\r\n    };\r\n    const wb = new ExcelJS.Workbook();\r\n    const ws = wb.addWorksheet('blort');\r\n\r\n    ws.getCell('A1').value = 'Hello, World!';\r\n    ws.getCell('A2').value = 7;\r\n\r\n    wb.xlsx\r\n      .writeBuffer(options)\r\n      .then(buffer => {\r\n        const wb2 = new ExcelJS.Workbook();\r\n        return wb2.xlsx.load(buffer.toString('base64'), options).then(() => {\r\n          const ws2 = wb2.getWorksheet('blort');\r\n          expect(ws2).toBeTruthy();\r\n\r\n          expect(ws2.getCell('A1').value).toEqual('Hello, World!');\r\n          expect(ws2.getCell('A2').value).toEqual(7);\r\n          done();\r\n        });\r\n      })\r\n      .catch(error => {\r\n        throw error;\r\n      })\r\n      .catch(unexpectedError(done));\r\n  });\r\n  it('should write csv via buffer', done => {\r\n    const wb = new ExcelJS.Workbook();\r\n    const ws = wb.addWorksheet('blort');\r\n\r\n    ws.getCell('A1').value = 'Hello, World!';\r\n    ws.getCell('B1').value = 'What time is it?';\r\n    ws.getCell('A2').value = 7;\r\n    ws.getCell('B2').value = '12pm';\r\n\r\n    wb.csv\r\n      .writeBuffer()\r\n      .then(buffer => {\r\n        expect(buffer.toString()).toEqual(\r\n          '\"Hello, World!\",What time is it?\\n7,12pm'\r\n        );\r\n        done();\r\n      })\r\n      .catch(error => {\r\n        throw error;\r\n      })\r\n      .catch(unexpectedError(done));\r\n  });\r\n});\r\n"],"mappings":"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"}