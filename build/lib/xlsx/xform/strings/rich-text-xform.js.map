{"version":3,"file":"rich-text-xform.js","names":["TextXform","require","FontXform","BaseXform","RichTextXform","_BaseXform","_inherits","_super","_createSuper","model","_this","_classCallCheck","call","_createClass","key","get","_textXform","_fontXform","FONT_OPTIONS","value","render","xmlStream","openNode","font","fontXform","textXform","text","closeNode","parseOpen","node","parser","name","parseText","parseClose","undefined","tagName","fontNameTag","module","exports"],"sources":["../../../../../lib/xlsx/xform/strings/rich-text-xform.js"],"sourcesContent":["const TextXform = require('./text-xform');\r\nconst FontXform = require('../style/font-xform');\r\n\r\nconst BaseXform = require('../base-xform');\r\n\r\n// <r>\r\n//   <rPr>\r\n//     <sz val=\"11\"/>\r\n//     <color theme=\"1\" tint=\"5\"/>\r\n//     <rFont val=\"Calibri\"/>\r\n//     <family val=\"2\"/>\r\n//     <scheme val=\"minor\"/>\r\n//   </rPr>\r\n//   <t xml:space=\"preserve\"> is </t>\r\n// </r>\r\n\r\nclass RichTextXform extends BaseXform {\r\n  constructor(model) {\r\n    super();\r\n\r\n    this.model = model;\r\n  }\r\n\r\n  get tag() {\r\n    return 'r';\r\n  }\r\n\r\n  get textXform() {\r\n    return this._textXform || (this._textXform = new TextXform());\r\n  }\r\n\r\n  get fontXform() {\r\n    return this._fontXform || (this._fontXform = new FontXform(RichTextXform.FONT_OPTIONS));\r\n  }\r\n\r\n  render(xmlStream, model) {\r\n    model = model || this.model;\r\n\r\n    xmlStream.openNode('r');\r\n    if (model.font) {\r\n      this.fontXform.render(xmlStream, model.font);\r\n    }\r\n    this.textXform.render(xmlStream, model.text);\r\n    xmlStream.closeNode();\r\n  }\r\n\r\n  parseOpen(node) {\r\n    if (this.parser) {\r\n      this.parser.parseOpen(node);\r\n      return true;\r\n    }\r\n    switch (node.name) {\r\n      case 'r':\r\n        this.model = {};\r\n        return true;\r\n      case 't':\r\n        this.parser = this.textXform;\r\n        this.parser.parseOpen(node);\r\n        return true;\r\n      case 'rPr':\r\n        this.parser = this.fontXform;\r\n        this.parser.parseOpen(node);\r\n        return true;\r\n      default:\r\n        return false;\r\n    }\r\n  }\r\n\r\n  parseText(text) {\r\n    if (this.parser) {\r\n      this.parser.parseText(text);\r\n    }\r\n  }\r\n\r\n  parseClose(name) {\r\n    switch (name) {\r\n      case 'r':\r\n        return false;\r\n      case 't':\r\n        this.model.text = this.parser.model;\r\n        this.parser = undefined;\r\n        return true;\r\n      case 'rPr':\r\n        this.model.font = this.parser.model;\r\n        this.parser = undefined;\r\n        return true;\r\n      default:\r\n        if (this.parser) {\r\n          this.parser.parseClose(name);\r\n        }\r\n        return true;\r\n    }\r\n  }\r\n}\r\n\r\nRichTextXform.FONT_OPTIONS = {\r\n  tagName: 'rPr',\r\n  fontNameTag: 'rFont',\r\n};\r\n\r\nmodule.exports = RichTextXform;\r\n"],"mappings":"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"}