{"version":3,"file":"conditional-formatting-ext-xform.js","names":["CompositeXform","require","SqRefExtXform","CfRuleExtXform","ConditionalFormattingExtXform","_CompositeXform","_inherits","_super","_createSuper","_this","_classCallCheck","call","map","sqRef","cfRule","_createClass","key","get","value","prepare","model","options","_this2","rules","forEach","rule","render","xmlStream","_this3","some","isExt","openNode","tag","filter","ref","closeNode","createNewModel","onParserClose","name","parser","push","module","exports"],"sources":["../../../../../../lib/xlsx/xform/sheet/cf-ext/conditional-formatting-ext-xform.js"],"sourcesContent":["const CompositeXform = require('../../composite-xform');\r\n\r\nconst SqRefExtXform = require('./sqref-ext-xform');\r\nconst CfRuleExtXform = require('./cf-rule-ext-xform');\r\n\r\nclass ConditionalFormattingExtXform extends CompositeXform {\r\n  constructor() {\r\n    super();\r\n\r\n    this.map = {\r\n      'xm:sqref': (this.sqRef = new SqRefExtXform()),\r\n      'x14:cfRule': (this.cfRule = new CfRuleExtXform()),\r\n    };\r\n  }\r\n\r\n  get tag() {\r\n    return 'x14:conditionalFormatting';\r\n  }\r\n\r\n  prepare(model, options) {\r\n    model.rules.forEach(rule => {\r\n      this.cfRule.prepare(rule, options);\r\n    });\r\n  }\r\n\r\n  render(xmlStream, model) {\r\n    if (!model.rules.some(CfRuleExtXform.isExt)) {\r\n      return;\r\n    }\r\n\r\n    xmlStream.openNode(this.tag, {\r\n      'xmlns:xm': 'http://schemas.microsoft.com/office/excel/2006/main',\r\n    });\r\n\r\n    model.rules.filter(CfRuleExtXform.isExt).forEach(rule => this.cfRule.render(xmlStream, rule));\r\n\r\n    // for some odd reason, Excel needs the <xm:sqref> node to be after the rules\r\n    this.sqRef.render(xmlStream, model.ref);\r\n\r\n    xmlStream.closeNode();\r\n  }\r\n\r\n  createNewModel() {\r\n    return {\r\n      rules: [],\r\n    };\r\n  }\r\n\r\n  onParserClose(name, parser) {\r\n    switch (name) {\r\n      case 'xm:sqref':\r\n        this.model.ref = parser.model;\r\n        break;\r\n\r\n      case 'x14:cfRule':\r\n        this.model.rules.push(parser.model);\r\n        break;\r\n    }\r\n  }\r\n}\r\n\r\nmodule.exports = ConditionalFormattingExtXform;\r\n"],"mappings":";;;;;;;;;;;;;;;AAAA,IAAMA,cAAc,GAAGC,OAAO,CAAC,uBAAuB,CAAC;AAEvD,IAAMC,aAAa,GAAGD,OAAO,CAAC,mBAAmB,CAAC;AAClD,IAAME,cAAc,GAAGF,OAAO,CAAC,qBAAqB,CAAC;AAAC,IAEhDG,6BAA6B,0BAAAC,eAAA;EAAAC,SAAA,CAAAF,6BAAA,EAAAC,eAAA;EAAA,IAAAE,MAAA,GAAAC,YAAA,CAAAJ,6BAAA;EACjC,SAAAA,8BAAA,EAAc;IAAA,IAAAK,KAAA;IAAAC,eAAA,OAAAN,6BAAA;IACZK,KAAA,GAAAF,MAAA,CAAAI,IAAA;IAEAF,KAAA,CAAKG,GAAG,GAAG;MACT,UAAU,EAAGH,KAAA,CAAKI,KAAK,GAAG,IAAIX,aAAa,CAAC,CAAE;MAC9C,YAAY,EAAGO,KAAA,CAAKK,MAAM,GAAG,IAAIX,cAAc,CAAC;IAClD,CAAC;IAAC,OAAAM,KAAA;EACJ;EAACM,YAAA,CAAAX,6BAAA;IAAAY,GAAA;IAAAC,GAAA,EAED,SAAAA,IAAA,EAAU;MACR,OAAO,2BAA2B;IACpC;EAAC;IAAAD,GAAA;IAAAE,KAAA,EAED,SAAAC,QAAQC,KAAK,EAAEC,OAAO,EAAE;MAAA,IAAAC,MAAA;MACtBF,KAAK,CAACG,KAAK,CAACC,OAAO,CAAC,UAAAC,IAAI,EAAI;QAC1BH,MAAI,CAACR,MAAM,CAACK,OAAO,CAACM,IAAI,EAAEJ,OAAO,CAAC;MACpC,CAAC,CAAC;IACJ;EAAC;IAAAL,GAAA;IAAAE,KAAA,EAED,SAAAQ,OAAOC,SAAS,EAAEP,KAAK,EAAE;MAAA,IAAAQ,MAAA;MACvB,IAAI,CAACR,KAAK,CAACG,KAAK,CAACM,IAAI,CAAC1B,cAAc,CAAC2B,KAAK,CAAC,EAAE;QAC3C;MACF;MAEAH,SAAS,CAACI,QAAQ,CAAC,IAAI,CAACC,GAAG,EAAE;QAC3B,UAAU,EAAE;MACd,CAAC,CAAC;MAEFZ,KAAK,CAACG,KAAK,CAACU,MAAM,CAAC9B,cAAc,CAAC2B,KAAK,CAAC,CAACN,OAAO,CAAC,UAAAC,IAAI;QAAA,OAAIG,MAAI,CAACd,MAAM,CAACY,MAAM,CAACC,SAAS,EAAEF,IAAI,CAAC;MAAA,EAAC;;MAE7F;MACA,IAAI,CAACZ,KAAK,CAACa,MAAM,CAACC,SAAS,EAAEP,KAAK,CAACc,GAAG,CAAC;MAEvCP,SAAS,CAACQ,SAAS,CAAC,CAAC;IACvB;EAAC;IAAAnB,GAAA;IAAAE,KAAA,EAED,SAAAkB,eAAA,EAAiB;MACf,OAAO;QACLb,KAAK,EAAE;MACT,CAAC;IACH;EAAC;IAAAP,GAAA;IAAAE,KAAA,EAED,SAAAmB,cAAcC,IAAI,EAAEC,MAAM,EAAE;MAC1B,QAAQD,IAAI;QACV,KAAK,UAAU;UACb,IAAI,CAAClB,KAAK,CAACc,GAAG,GAAGK,MAAM,CAACnB,KAAK;UAC7B;QAEF,KAAK,YAAY;UACf,IAAI,CAACA,KAAK,CAACG,KAAK,CAACiB,IAAI,CAACD,MAAM,CAACnB,KAAK,CAAC;UACnC;MACJ;IACF;EAAC;EAAA,OAAAhB,6BAAA;AAAA,EArDyCJ,cAAc;AAwD1DyC,MAAM,CAACC,OAAO,GAAGtC,6BAA6B"}