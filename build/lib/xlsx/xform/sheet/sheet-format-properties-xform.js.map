{"version":3,"file":"sheet-format-properties-xform.js","names":["_","require","BaseXform","SheetFormatPropertiesXform","_BaseXform","_inherits","_super","_createSuper","_classCallCheck","apply","arguments","_createClass","key","get","value","render","xmlStream","model","attributes","defaultRowHeight","outlineLevelRow","outlineLevelCol","dyDescent","defaultColWidth","customHeight","some","undefined","leafNode","parseOpen","node","name","parseFloat","parseInt","parseText","parseClose","module","exports"],"sources":["../../../../../lib/xlsx/xform/sheet/sheet-format-properties-xform.js"],"sourcesContent":["const _ = require('../../../utils/under-dash');\r\nconst BaseXform = require('../base-xform');\r\n\r\nclass SheetFormatPropertiesXform extends BaseXform {\r\n  get tag() {\r\n    return 'sheetFormatPr';\r\n  }\r\n\r\n  render(xmlStream, model) {\r\n    if (model) {\r\n      const attributes = {\r\n        defaultRowHeight: model.defaultRowHeight,\r\n        outlineLevelRow: model.outlineLevelRow,\r\n        outlineLevelCol: model.outlineLevelCol,\r\n        'x14ac:dyDescent': model.dyDescent,\r\n      };\r\n      if (model.defaultColWidth) {\r\n        attributes.defaultColWidth = model.defaultColWidth;\r\n      }\r\n\r\n      // default value for 'defaultRowHeight' is 15, this should not be 'custom'\r\n      if (!model.defaultRowHeight || model.defaultRowHeight !== 15) {\r\n        attributes.customHeight = '1';\r\n      }\r\n\r\n      if (_.some(attributes, value => value !== undefined)) {\r\n        xmlStream.leafNode('sheetFormatPr', attributes);\r\n      }\r\n    }\r\n  }\r\n\r\n  parseOpen(node) {\r\n    if (node.name === 'sheetFormatPr') {\r\n      this.model = {\r\n        defaultRowHeight: parseFloat(node.attributes.defaultRowHeight || '0'),\r\n        dyDescent: parseFloat(node.attributes['x14ac:dyDescent'] || '0'),\r\n        outlineLevelRow: parseInt(node.attributes.outlineLevelRow || '0', 10),\r\n        outlineLevelCol: parseInt(node.attributes.outlineLevelCol || '0', 10),\r\n      };\r\n      if (node.attributes.defaultColWidth) {\r\n        this.model.defaultColWidth = parseFloat(node.attributes.defaultColWidth);\r\n      }\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  parseText() {}\r\n\r\n  parseClose() {\r\n    return false;\r\n  }\r\n}\r\n\r\nmodule.exports = SheetFormatPropertiesXform;\r\n"],"mappings":";;;;;;;;;;;;;;;AAAA,IAAMA,CAAC,GAAGC,OAAO,CAAC,2BAA2B,CAAC;AAC9C,IAAMC,SAAS,GAAGD,OAAO,CAAC,eAAe,CAAC;AAAC,IAErCE,0BAA0B,0BAAAC,UAAA;EAAAC,SAAA,CAAAF,0BAAA,EAAAC,UAAA;EAAA,IAAAE,MAAA,GAAAC,YAAA,CAAAJ,0BAAA;EAAA,SAAAA,2BAAA;IAAAK,eAAA,OAAAL,0BAAA;IAAA,OAAAG,MAAA,CAAAG,KAAA,OAAAC,SAAA;EAAA;EAAAC,YAAA,CAAAR,0BAAA;IAAAS,GAAA;IAAAC,GAAA,EAC9B,SAAAA,IAAA,EAAU;MACR,OAAO,eAAe;IACxB;EAAC;IAAAD,GAAA;IAAAE,KAAA,EAED,SAAAC,OAAOC,SAAS,EAAEC,KAAK,EAAE;MACvB,IAAIA,KAAK,EAAE;QACT,IAAMC,UAAU,GAAG;UACjBC,gBAAgB,EAAEF,KAAK,CAACE,gBAAgB;UACxCC,eAAe,EAAEH,KAAK,CAACG,eAAe;UACtCC,eAAe,EAAEJ,KAAK,CAACI,eAAe;UACtC,iBAAiB,EAAEJ,KAAK,CAACK;QAC3B,CAAC;QACD,IAAIL,KAAK,CAACM,eAAe,EAAE;UACzBL,UAAU,CAACK,eAAe,GAAGN,KAAK,CAACM,eAAe;QACpD;;QAEA;QACA,IAAI,CAACN,KAAK,CAACE,gBAAgB,IAAIF,KAAK,CAACE,gBAAgB,KAAK,EAAE,EAAE;UAC5DD,UAAU,CAACM,YAAY,GAAG,GAAG;QAC/B;QAEA,IAAIxB,CAAC,CAACyB,IAAI,CAACP,UAAU,EAAE,UAAAJ,KAAK;UAAA,OAAIA,KAAK,KAAKY,SAAS;QAAA,EAAC,EAAE;UACpDV,SAAS,CAACW,QAAQ,CAAC,eAAe,EAAET,UAAU,CAAC;QACjD;MACF;IACF;EAAC;IAAAN,GAAA;IAAAE,KAAA,EAED,SAAAc,UAAUC,IAAI,EAAE;MACd,IAAIA,IAAI,CAACC,IAAI,KAAK,eAAe,EAAE;QACjC,IAAI,CAACb,KAAK,GAAG;UACXE,gBAAgB,EAAEY,UAAU,CAACF,IAAI,CAACX,UAAU,CAACC,gBAAgB,IAAI,GAAG,CAAC;UACrEG,SAAS,EAAES,UAAU,CAACF,IAAI,CAACX,UAAU,CAAC,iBAAiB,CAAC,IAAI,GAAG,CAAC;UAChEE,eAAe,EAAEY,QAAQ,CAACH,IAAI,CAACX,UAAU,CAACE,eAAe,IAAI,GAAG,EAAE,EAAE,CAAC;UACrEC,eAAe,EAAEW,QAAQ,CAACH,IAAI,CAACX,UAAU,CAACG,eAAe,IAAI,GAAG,EAAE,EAAE;QACtE,CAAC;QACD,IAAIQ,IAAI,CAACX,UAAU,CAACK,eAAe,EAAE;UACnC,IAAI,CAACN,KAAK,CAACM,eAAe,GAAGQ,UAAU,CAACF,IAAI,CAACX,UAAU,CAACK,eAAe,CAAC;QAC1E;QACA,OAAO,IAAI;MACb;MACA,OAAO,KAAK;IACd;EAAC;IAAAX,GAAA;IAAAE,KAAA,EAED,SAAAmB,UAAA,EAAY,CAAC;EAAC;IAAArB,GAAA;IAAAE,KAAA,EAEd,SAAAoB,WAAA,EAAa;MACX,OAAO,KAAK;IACd;EAAC;EAAA,OAAA/B,0BAAA;AAAA,EAhDsCD,SAAS;AAmDlDiC,MAAM,CAACC,OAAO,GAAGjC,0BAA0B"}