{"version":3,"file":"auto-filter-xform.js","names":["colCache","require","BaseXform","AutoFilterXform","_BaseXform","_inherits","_super","_createSuper","_classCallCheck","apply","arguments","_createClass","key","get","value","render","xmlStream","model","leafNode","ref","getAddress","addr","row","column","address","firstAddress","from","secondAddress","to","concat","parseOpen","node","name","attributes","module","exports"],"sources":["../../../../../lib/xlsx/xform/sheet/auto-filter-xform.js"],"sourcesContent":["const colCache = require('../../../utils/col-cache');\r\nconst BaseXform = require('../base-xform');\r\n\r\nclass AutoFilterXform extends BaseXform {\r\n  get tag() {\r\n    return 'autoFilter';\r\n  }\r\n\r\n  render(xmlStream, model) {\r\n    if (model) {\r\n      if (typeof model === 'string') {\r\n        // assume range\r\n        xmlStream.leafNode('autoFilter', {ref: model});\r\n      } else {\r\n        const getAddress = function(addr) {\r\n          if (typeof addr === 'string') {\r\n            return addr;\r\n          }\r\n          return colCache.getAddress(addr.row, addr.column).address;\r\n        };\r\n\r\n        const firstAddress = getAddress(model.from);\r\n        const secondAddress = getAddress(model.to);\r\n        if (firstAddress && secondAddress) {\r\n          xmlStream.leafNode('autoFilter', {ref: `${firstAddress}:${secondAddress}`});\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  parseOpen(node) {\r\n    if (node.name === 'autoFilter') {\r\n      this.model = node.attributes.ref;\r\n    }\r\n  }\r\n}\r\n\r\nmodule.exports = AutoFilterXform;\r\n"],"mappings":";;;;;;;;;;;;;;;AAAA,IAAMA,QAAQ,GAAGC,OAAO,CAAC,0BAA0B,CAAC;AACpD,IAAMC,SAAS,GAAGD,OAAO,CAAC,eAAe,CAAC;AAAC,IAErCE,eAAe,0BAAAC,UAAA;EAAAC,SAAA,CAAAF,eAAA,EAAAC,UAAA;EAAA,IAAAE,MAAA,GAAAC,YAAA,CAAAJ,eAAA;EAAA,SAAAA,gBAAA;IAAAK,eAAA,OAAAL,eAAA;IAAA,OAAAG,MAAA,CAAAG,KAAA,OAAAC,SAAA;EAAA;EAAAC,YAAA,CAAAR,eAAA;IAAAS,GAAA;IAAAC,GAAA,EACnB,SAAAA,IAAA,EAAU;MACR,OAAO,YAAY;IACrB;EAAC;IAAAD,GAAA;IAAAE,KAAA,EAED,SAAAC,OAAOC,SAAS,EAAEC,KAAK,EAAE;MACvB,IAAIA,KAAK,EAAE;QACT,IAAI,OAAOA,KAAK,KAAK,QAAQ,EAAE;UAC7B;UACAD,SAAS,CAACE,QAAQ,CAAC,YAAY,EAAE;YAACC,GAAG,EAAEF;UAAK,CAAC,CAAC;QAChD,CAAC,MAAM;UACL,IAAMG,UAAU,GAAG,SAAbA,UAAUA,CAAYC,IAAI,EAAE;YAChC,IAAI,OAAOA,IAAI,KAAK,QAAQ,EAAE;cAC5B,OAAOA,IAAI;YACb;YACA,OAAOrB,QAAQ,CAACoB,UAAU,CAACC,IAAI,CAACC,GAAG,EAAED,IAAI,CAACE,MAAM,CAAC,CAACC,OAAO;UAC3D,CAAC;UAED,IAAMC,YAAY,GAAGL,UAAU,CAACH,KAAK,CAACS,IAAI,CAAC;UAC3C,IAAMC,aAAa,GAAGP,UAAU,CAACH,KAAK,CAACW,EAAE,CAAC;UAC1C,IAAIH,YAAY,IAAIE,aAAa,EAAE;YACjCX,SAAS,CAACE,QAAQ,CAAC,YAAY,EAAE;cAACC,GAAG,KAAAU,MAAA,CAAKJ,YAAY,OAAAI,MAAA,CAAIF,aAAa;YAAE,CAAC,CAAC;UAC7E;QACF;MACF;IACF;EAAC;IAAAf,GAAA;IAAAE,KAAA,EAED,SAAAgB,UAAUC,IAAI,EAAE;MACd,IAAIA,IAAI,CAACC,IAAI,KAAK,YAAY,EAAE;QAC9B,IAAI,CAACf,KAAK,GAAGc,IAAI,CAACE,UAAU,CAACd,GAAG;MAClC;IACF;EAAC;EAAA,OAAAhB,eAAA;AAAA,EA/B2BD,SAAS;AAkCvCgC,MAAM,CAACC,OAAO,GAAGhC,eAAe"}