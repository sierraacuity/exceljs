{"version":3,"file":"cf-rule-xform.js","names":["BaseXform","require","CompositeXform","Range","DatabarXform","ExtLstRefXform","FormulaXform","ColorScaleXform","IconSetXform","extIcons","getTextFormula","model","formulae","range","ref","tl","operator","concat","text","undefined","getTimePeriodFormula","timePeriod","opType","attributes","type","CfRuleXform","_CompositeXform","_inherits","_super","_createSuper","_this","_classCallCheck","call","map","dataBar","databarXform","extLst","extLstRefXform","formula","formulaXform","colorScale","colorScaleXform","iconSet","iconSetXform","_createClass","key","get","value","render","xmlStream","renderExpression","renderCellIs","renderTop10","renderAboveAverage","renderDataBar","renderColorScale","renderIconSet","renderText","renderTimePeriod","openNode","tag","dxfId","priority","closeNode","_this2","forEach","leafNode","percent","toBoolAttribute","bottom","rank","toIntValue","aboveAverage","isPrimitive","toStringAttribute","createNewModel","_ref","_objectSpread","toBoolValue","onParserClose","name","parser","Object","assign","push","rule","custom","module","exports"],"sources":["../../../../../../lib/xlsx/xform/sheet/cf/cf-rule-xform.js"],"sourcesContent":["const BaseXform = require('../../base-xform');\r\nconst CompositeXform = require('../../composite-xform');\r\n\r\nconst Range = require('../../../../doc/range');\r\n\r\nconst DatabarXform = require('./databar-xform');\r\nconst ExtLstRefXform = require('./ext-lst-ref-xform');\r\nconst FormulaXform = require('./formula-xform');\r\nconst ColorScaleXform = require('./color-scale-xform');\r\nconst IconSetXform = require('./icon-set-xform');\r\n\r\nconst extIcons = {\r\n  '3Triangles': true,\r\n  '3Stars': true,\r\n  '5Boxes': true,\r\n};\r\n\r\nconst getTextFormula = model => {\r\n  if (model.formulae && model.formulae[0]) {\r\n    return model.formulae[0];\r\n  }\r\n\r\n  const range = new Range(model.ref);\r\n  const {tl} = range;\r\n  switch (model.operator) {\r\n    case 'containsText':\r\n      return `NOT(ISERROR(SEARCH(\"${model.text}\",${tl})))`;\r\n    case 'containsBlanks':\r\n      return `LEN(TRIM(${tl}))=0`;\r\n    case 'notContainsBlanks':\r\n      return `LEN(TRIM(${tl}))>0`;\r\n    case 'containsErrors':\r\n      return `ISERROR(${tl})`;\r\n    case 'notContainsErrors':\r\n      return `NOT(ISERROR(${tl}))`;\r\n    default:\r\n      return undefined;\r\n  }\r\n};\r\n\r\nconst getTimePeriodFormula = model => {\r\n  if (model.formulae && model.formulae[0]) {\r\n    return model.formulae[0];\r\n  }\r\n\r\n  const range = new Range(model.ref);\r\n  const {tl} = range;\r\n  switch (model.timePeriod) {\r\n    case 'thisWeek':\r\n      return `AND(TODAY()-ROUNDDOWN(${tl},0)<=WEEKDAY(TODAY())-1,ROUNDDOWN(${tl},0)-TODAY()<=7-WEEKDAY(TODAY()))`;\r\n    case 'lastWeek':\r\n      return `AND(TODAY()-ROUNDDOWN(${tl},0)>=(WEEKDAY(TODAY())),TODAY()-ROUNDDOWN(${tl},0)<(WEEKDAY(TODAY())+7))`;\r\n    case 'nextWeek':\r\n      return `AND(ROUNDDOWN(${tl},0)-TODAY()>(7-WEEKDAY(TODAY())),ROUNDDOWN(${tl},0)-TODAY()<(15-WEEKDAY(TODAY())))`;\r\n    case 'yesterday':\r\n      return `FLOOR(${tl},1)=TODAY()-1`;\r\n    case 'today':\r\n      return `FLOOR(${tl},1)=TODAY()`;\r\n    case 'tomorrow':\r\n      return `FLOOR(${tl},1)=TODAY()+1`;\r\n    case 'last7Days':\r\n      return `AND(TODAY()-FLOOR(${tl},1)<=6,FLOOR(${tl},1)<=TODAY())`;\r\n    case 'lastMonth':\r\n      return `AND(MONTH(${tl})=MONTH(EDATE(TODAY(),0-1)),YEAR(${tl})=YEAR(EDATE(TODAY(),0-1)))`;\r\n    case 'thisMonth':\r\n      return `AND(MONTH(${tl})=MONTH(TODAY()),YEAR(${tl})=YEAR(TODAY()))`;\r\n    case 'nextMonth':\r\n      return `AND(MONTH(${tl})=MONTH(EDATE(TODAY(),0+1)),YEAR(${tl})=YEAR(EDATE(TODAY(),0+1)))`;\r\n    default:\r\n      return undefined;\r\n  }\r\n};\r\n\r\nconst opType = attributes => {\r\n  const {type, operator} = attributes;\r\n  switch (type) {\r\n    case 'containsText':\r\n    case 'containsBlanks':\r\n    case 'notContainsBlanks':\r\n    case 'containsErrors':\r\n    case 'notContainsErrors':\r\n      return {\r\n        type: 'containsText',\r\n        operator: type,\r\n      };\r\n\r\n    default:\r\n      return {type, operator};\r\n  }\r\n};\r\n\r\nclass CfRuleXform extends CompositeXform {\r\n  constructor() {\r\n    super();\r\n\r\n    this.map = {\r\n      dataBar: (this.databarXform = new DatabarXform()),\r\n      extLst: (this.extLstRefXform = new ExtLstRefXform()),\r\n      formula: (this.formulaXform = new FormulaXform()),\r\n      colorScale: (this.colorScaleXform = new ColorScaleXform()),\r\n      iconSet: (this.iconSetXform = new IconSetXform()),\r\n    };\r\n  }\r\n\r\n  get tag() {\r\n    return 'cfRule';\r\n  }\r\n\r\n  static isPrimitive(rule) {\r\n    // is this rule primitive?\r\n    if (rule.type === 'iconSet') {\r\n      if (rule.custom || extIcons[rule.iconSet]) {\r\n        return false;\r\n      }\r\n    }\r\n    return true;\r\n  }\r\n\r\n  render(xmlStream, model) {\r\n    switch (model.type) {\r\n      case 'expression':\r\n        this.renderExpression(xmlStream, model);\r\n        break;\r\n      case 'cellIs':\r\n        this.renderCellIs(xmlStream, model);\r\n        break;\r\n      case 'top10':\r\n        this.renderTop10(xmlStream, model);\r\n        break;\r\n      case 'aboveAverage':\r\n        this.renderAboveAverage(xmlStream, model);\r\n        break;\r\n      case 'dataBar':\r\n        this.renderDataBar(xmlStream, model);\r\n        break;\r\n      case 'colorScale':\r\n        this.renderColorScale(xmlStream, model);\r\n        break;\r\n      case 'iconSet':\r\n        this.renderIconSet(xmlStream, model);\r\n        break;\r\n      case 'containsText':\r\n        this.renderText(xmlStream, model);\r\n        break;\r\n      case 'timePeriod':\r\n        this.renderTimePeriod(xmlStream, model);\r\n        break;\r\n    }\r\n  }\r\n\r\n  renderExpression(xmlStream, model) {\r\n    xmlStream.openNode(this.tag, {\r\n      type: 'expression',\r\n      dxfId: model.dxfId,\r\n      priority: model.priority,\r\n    });\r\n\r\n    this.formulaXform.render(xmlStream, model.formulae[0]);\r\n\r\n    xmlStream.closeNode();\r\n  }\r\n\r\n  renderCellIs(xmlStream, model) {\r\n    xmlStream.openNode(this.tag, {\r\n      type: 'cellIs',\r\n      dxfId: model.dxfId,\r\n      priority: model.priority,\r\n      operator: model.operator,\r\n    });\r\n\r\n    model.formulae.forEach(formula => {\r\n      this.formulaXform.render(xmlStream, formula);\r\n    });\r\n\r\n    xmlStream.closeNode();\r\n  }\r\n\r\n  renderTop10(xmlStream, model) {\r\n    xmlStream.leafNode(this.tag, {\r\n      type: 'top10',\r\n      dxfId: model.dxfId,\r\n      priority: model.priority,\r\n      percent: BaseXform.toBoolAttribute(model.percent, false),\r\n      bottom: BaseXform.toBoolAttribute(model.bottom, false),\r\n      rank: BaseXform.toIntValue(model.rank, 10, true),\r\n    });\r\n  }\r\n\r\n  renderAboveAverage(xmlStream, model) {\r\n    xmlStream.leafNode(this.tag, {\r\n      type: 'aboveAverage',\r\n      dxfId: model.dxfId,\r\n      priority: model.priority,\r\n      aboveAverage: BaseXform.toBoolAttribute(model.aboveAverage, true),\r\n    });\r\n  }\r\n\r\n  renderDataBar(xmlStream, model) {\r\n    xmlStream.openNode(this.tag, {\r\n      type: 'dataBar',\r\n      priority: model.priority,\r\n    });\r\n\r\n    this.databarXform.render(xmlStream, model);\r\n    this.extLstRefXform.render(xmlStream, model);\r\n\r\n    xmlStream.closeNode();\r\n  }\r\n\r\n  renderColorScale(xmlStream, model) {\r\n    xmlStream.openNode(this.tag, {\r\n      type: 'colorScale',\r\n      priority: model.priority,\r\n    });\r\n\r\n    this.colorScaleXform.render(xmlStream, model);\r\n\r\n    xmlStream.closeNode();\r\n  }\r\n\r\n  renderIconSet(xmlStream, model) {\r\n    // iconset is all primitive or all extLst\r\n    if (!CfRuleXform.isPrimitive(model)) {\r\n      return;\r\n    }\r\n\r\n    xmlStream.openNode(this.tag, {\r\n      type: 'iconSet',\r\n      priority: model.priority,\r\n    });\r\n\r\n    this.iconSetXform.render(xmlStream, model);\r\n\r\n    xmlStream.closeNode();\r\n  }\r\n\r\n  renderText(xmlStream, model) {\r\n    xmlStream.openNode(this.tag, {\r\n      type: model.operator,\r\n      dxfId: model.dxfId,\r\n      priority: model.priority,\r\n      operator: BaseXform.toStringAttribute(model.operator, 'containsText'),\r\n    });\r\n\r\n    const formula = getTextFormula(model);\r\n    if (formula) {\r\n      this.formulaXform.render(xmlStream, formula);\r\n    }\r\n\r\n    xmlStream.closeNode();\r\n  }\r\n\r\n  renderTimePeriod(xmlStream, model) {\r\n    xmlStream.openNode(this.tag, {\r\n      type: 'timePeriod',\r\n      dxfId: model.dxfId,\r\n      priority: model.priority,\r\n      timePeriod: model.timePeriod,\r\n    });\r\n\r\n    const formula = getTimePeriodFormula(model);\r\n    if (formula) {\r\n      this.formulaXform.render(xmlStream, formula);\r\n    }\r\n\r\n    xmlStream.closeNode();\r\n  }\r\n\r\n  createNewModel({attributes}) {\r\n    return {\r\n      ...opType(attributes),\r\n      dxfId: BaseXform.toIntValue(attributes.dxfId),\r\n      priority: BaseXform.toIntValue(attributes.priority),\r\n      timePeriod: attributes.timePeriod,\r\n      percent: BaseXform.toBoolValue(attributes.percent),\r\n      bottom: BaseXform.toBoolValue(attributes.bottom),\r\n      rank: BaseXform.toIntValue(attributes.rank),\r\n      aboveAverage: BaseXform.toBoolValue(attributes.aboveAverage),\r\n    };\r\n  }\r\n\r\n  onParserClose(name, parser) {\r\n    switch (name) {\r\n      case 'dataBar':\r\n      case 'extLst':\r\n      case 'colorScale':\r\n      case 'iconSet':\r\n        // merge parser model with ours\r\n        Object.assign(this.model, parser.model);\r\n        break;\r\n\r\n      case 'formula':\r\n        // except - formula is a string and appends to formulae\r\n        this.model.formulae = this.model.formulae || [];\r\n        this.model.formulae.push(parser.model);\r\n        break;\r\n    }\r\n  }\r\n}\r\n\r\nmodule.exports = CfRuleXform;\r\n"],"mappings":"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"}