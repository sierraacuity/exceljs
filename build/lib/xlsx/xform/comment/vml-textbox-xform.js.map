{"version":3,"file":"vml-textbox-xform.js","names":["BaseXform","require","VmlTextboxXform","_BaseXform","_inherits","_super","_createSuper","_classCallCheck","apply","arguments","_createClass","key","get","value","conversionUnit","multiple","unit","concat","parseFloat","toFixed","reverseConversionUnit","inset","_this","split","map","margin","Number","render","xmlStream","model","_this2","attributes","style","note","_ref","margins","Array","isArray","join","openNode","leafNode","closeNode","parseOpen","node","name","tag","parseText","parseClose","module","exports"],"sources":["../../../../../lib/xlsx/xform/comment/vml-textbox-xform.js"],"sourcesContent":["const BaseXform = require('../base-xform');\r\n\r\nclass VmlTextboxXform extends BaseXform {\r\n  get tag() {\r\n    return 'v:textbox';\r\n  }\r\n\r\n  conversionUnit(value, multiple, unit) {\r\n    return `${parseFloat(value) * multiple.toFixed(2)}${unit}`;\r\n  }\r\n\r\n  reverseConversionUnit(inset) {\r\n    return (inset || '').split(',').map(margin => {\r\n      return Number(parseFloat(this.conversionUnit(parseFloat(margin), 0.1, '')).toFixed(2));\r\n    });\r\n  }\r\n\r\n  render(xmlStream, model) {\r\n    const attributes = {\r\n      style: 'mso-direction-alt:auto',\r\n    };\r\n    if (model && model.note) {\r\n      let {inset} = model.note && model.note.margins;\r\n      if (Array.isArray(inset)) {\r\n        inset = inset\r\n          .map(margin => {\r\n            return this.conversionUnit(margin, 10, 'mm');\r\n          })\r\n          .join(',');\r\n      }\r\n      if (inset) {\r\n        attributes.inset = inset;\r\n      }\r\n    }\r\n    xmlStream.openNode('v:textbox', attributes);\r\n    xmlStream.leafNode('div', {style: 'text-align:left'});\r\n    xmlStream.closeNode();\r\n  }\r\n\r\n  parseOpen(node) {\r\n    switch (node.name) {\r\n      case this.tag:\r\n        this.model = {\r\n          inset: this.reverseConversionUnit(node.attributes.inset),\r\n        };\r\n        return true;\r\n      default:\r\n        return true;\r\n    }\r\n  }\r\n\r\n  parseText() {}\r\n\r\n  parseClose(name) {\r\n    switch (name) {\r\n      case this.tag:\r\n        return false;\r\n      default:\r\n        return true;\r\n    }\r\n  }\r\n}\r\n\r\nmodule.exports = VmlTextboxXform;\r\n"],"mappings":"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"}