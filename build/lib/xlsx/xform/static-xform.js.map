{"version":3,"file":"static-xform.js","names":["BaseXform","require","XmlStream","build","xmlStream","model","openNode","tag","$","c","forEach","child","t","writeText","closeNode","StaticXform","_BaseXform","_inherits","_super","_createSuper","_this","_classCallCheck","call","_model","_createClass","key","value","render","_xml","stream","xml","writeXml","parseOpen","parseText","parseClose","name","module","exports"],"sources":["../../../../lib/xlsx/xform/static-xform.js"],"sourcesContent":["const BaseXform = require('./base-xform');\r\nconst XmlStream = require('../../utils/xml-stream');\r\n\r\n// const model = {\r\n//   tag: 'name',\r\n//   $: {attr: 'value'},\r\n//   c: [\r\n//     { tag: 'child' }\r\n//   ],\r\n//   t: 'some text'\r\n// };\r\n\r\nfunction build(xmlStream, model) {\r\n  xmlStream.openNode(model.tag, model.$);\r\n  if (model.c) {\r\n    model.c.forEach(child => {\r\n      build(xmlStream, child);\r\n    });\r\n  }\r\n  if (model.t) {\r\n    xmlStream.writeText(model.t);\r\n  }\r\n  xmlStream.closeNode();\r\n}\r\n\r\nclass StaticXform extends BaseXform {\r\n  constructor(model) {\r\n    super();\r\n\r\n    // This class is an optimisation for static (unimportant and unchanging) xml\r\n    // It is stateless - apart from its static model and so can be used as a singleton\r\n    // Being stateless - it will only track entry to and exit from it's root xml tag during parsing and nothing else\r\n    // Known issues:\r\n    //    since stateless - parseOpen always returns true. Parent xform must know when to start using this xform\r\n    //    if the root tag is recursive, the parsing will behave unpredictably\r\n    this._model = model;\r\n  }\r\n\r\n  render(xmlStream) {\r\n    if (!this._xml) {\r\n      const stream = new XmlStream();\r\n      build(stream, this._model);\r\n      this._xml = stream.xml;\r\n    }\r\n    xmlStream.writeXml(this._xml);\r\n  }\r\n\r\n  parseOpen() {\r\n    return true;\r\n  }\r\n\r\n  parseText() {}\r\n\r\n  parseClose(name) {\r\n    switch (name) {\r\n      case this._model.tag:\r\n        return false;\r\n      default:\r\n        return true;\r\n    }\r\n  }\r\n}\r\n\r\nmodule.exports = StaticXform;\r\n"],"mappings":";;;;;;;;;;;;;;;AAAA,IAAMA,SAAS,GAAGC,OAAO,CAAC,cAAc,CAAC;AACzC,IAAMC,SAAS,GAAGD,OAAO,CAAC,wBAAwB,CAAC;;AAEnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,SAASE,KAAKA,CAACC,SAAS,EAAEC,KAAK,EAAE;EAC/BD,SAAS,CAACE,QAAQ,CAACD,KAAK,CAACE,GAAG,EAAEF,KAAK,CAACG,CAAC,CAAC;EACtC,IAAIH,KAAK,CAACI,CAAC,EAAE;IACXJ,KAAK,CAACI,CAAC,CAACC,OAAO,CAAC,UAAAC,KAAK,EAAI;MACvBR,KAAK,CAACC,SAAS,EAAEO,KAAK,CAAC;IACzB,CAAC,CAAC;EACJ;EACA,IAAIN,KAAK,CAACO,CAAC,EAAE;IACXR,SAAS,CAACS,SAAS,CAACR,KAAK,CAACO,CAAC,CAAC;EAC9B;EACAR,SAAS,CAACU,SAAS,CAAC,CAAC;AACvB;AAAC,IAEKC,WAAW,0BAAAC,UAAA;EAAAC,SAAA,CAAAF,WAAA,EAAAC,UAAA;EAAA,IAAAE,MAAA,GAAAC,YAAA,CAAAJ,WAAA;EACf,SAAAA,YAAYV,KAAK,EAAE;IAAA,IAAAe,KAAA;IAAAC,eAAA,OAAAN,WAAA;IACjBK,KAAA,GAAAF,MAAA,CAAAI,IAAA;;IAEA;IACA;IACA;IACA;IACA;IACA;IACAF,KAAA,CAAKG,MAAM,GAAGlB,KAAK;IAAC,OAAAe,KAAA;EACtB;EAACI,YAAA,CAAAT,WAAA;IAAAU,GAAA;IAAAC,KAAA,EAED,SAAAC,OAAOvB,SAAS,EAAE;MAChB,IAAI,CAAC,IAAI,CAACwB,IAAI,EAAE;QACd,IAAMC,MAAM,GAAG,IAAI3B,SAAS,CAAC,CAAC;QAC9BC,KAAK,CAAC0B,MAAM,EAAE,IAAI,CAACN,MAAM,CAAC;QAC1B,IAAI,CAACK,IAAI,GAAGC,MAAM,CAACC,GAAG;MACxB;MACA1B,SAAS,CAAC2B,QAAQ,CAAC,IAAI,CAACH,IAAI,CAAC;IAC/B;EAAC;IAAAH,GAAA;IAAAC,KAAA,EAED,SAAAM,UAAA,EAAY;MACV,OAAO,IAAI;IACb;EAAC;IAAAP,GAAA;IAAAC,KAAA,EAED,SAAAO,UAAA,EAAY,CAAC;EAAC;IAAAR,GAAA;IAAAC,KAAA,EAEd,SAAAQ,WAAWC,IAAI,EAAE;MACf,QAAQA,IAAI;QACV,KAAK,IAAI,CAACZ,MAAM,CAAChB,GAAG;UAClB,OAAO,KAAK;QACd;UACE,OAAO,IAAI;MACf;IACF;EAAC;EAAA,OAAAQ,WAAA;AAAA,EAnCuBf,SAAS;AAsCnCoC,MAAM,CAACC,OAAO,GAAGtB,WAAW"}