{"version":3,"file":"protection-xform.js","names":["BaseXform","require","validation","boolean","value","dflt","undefined","ProtectionXform","_BaseXform","_inherits","_super","_createSuper","_classCallCheck","apply","arguments","_createClass","key","get","render","xmlStream","model","addRollback","openNode","isValid","add","name","addAttribute","locked","hidden","closeNode","commit","rollback","parseOpen","node","attributes","isSignificant","parseText","parseClose","module","exports"],"sources":["../../../../../lib/xlsx/xform/style/protection-xform.js"],"sourcesContent":["const BaseXform = require('../base-xform');\r\n\r\nconst validation = {\r\n  boolean(value, dflt) {\r\n    if (value === undefined) {\r\n      return dflt;\r\n    }\r\n    return value;\r\n  },\r\n};\r\n\r\n// Protection encapsulates translation from style.protection model to/from xlsx\r\nclass ProtectionXform extends BaseXform {\r\n  get tag() {\r\n    return 'protection';\r\n  }\r\n\r\n  render(xmlStream, model) {\r\n    xmlStream.addRollback();\r\n    xmlStream.openNode('protection');\r\n\r\n    let isValid = false;\r\n    function add(name, value) {\r\n      if (value !== undefined) {\r\n        xmlStream.addAttribute(name, value);\r\n        isValid = true;\r\n      }\r\n    }\r\n    add('locked', validation.boolean(model.locked, true) ? undefined : '0');\r\n    add('hidden', validation.boolean(model.hidden, false) ? '1' : undefined);\r\n\r\n    xmlStream.closeNode();\r\n\r\n    if (isValid) {\r\n      xmlStream.commit();\r\n    } else {\r\n      xmlStream.rollback();\r\n    }\r\n  }\r\n\r\n  parseOpen(node) {\r\n    const model = {\r\n      locked: !(node.attributes.locked === '0'),\r\n      hidden: node.attributes.hidden === '1',\r\n    };\r\n\r\n    // only want to record models that differ from defaults\r\n    const isSignificant = !model.locked || model.hidden;\r\n\r\n    this.model = isSignificant ? model : null;\r\n  }\r\n\r\n  parseText() {}\r\n\r\n  parseClose() {\r\n    return false;\r\n  }\r\n}\r\n\r\nmodule.exports = ProtectionXform;\r\n"],"mappings":";;;;;;;;;;;;;;;AAAA,IAAMA,SAAS,GAAGC,OAAO,CAAC,eAAe,CAAC;AAE1C,IAAMC,UAAU,GAAG;EACjBC,OAAO,WAAAA,QAACC,KAAK,EAAEC,IAAI,EAAE;IACnB,IAAID,KAAK,KAAKE,SAAS,EAAE;MACvB,OAAOD,IAAI;IACb;IACA,OAAOD,KAAK;EACd;AACF,CAAC;;AAED;AAAA,IACMG,eAAe,0BAAAC,UAAA;EAAAC,SAAA,CAAAF,eAAA,EAAAC,UAAA;EAAA,IAAAE,MAAA,GAAAC,YAAA,CAAAJ,eAAA;EAAA,SAAAA,gBAAA;IAAAK,eAAA,OAAAL,eAAA;IAAA,OAAAG,MAAA,CAAAG,KAAA,OAAAC,SAAA;EAAA;EAAAC,YAAA,CAAAR,eAAA;IAAAS,GAAA;IAAAC,GAAA,EACnB,SAAAA,IAAA,EAAU;MACR,OAAO,YAAY;IACrB;EAAC;IAAAD,GAAA;IAAAZ,KAAA,EAED,SAAAc,OAAOC,SAAS,EAAEC,KAAK,EAAE;MACvBD,SAAS,CAACE,WAAW,CAAC,CAAC;MACvBF,SAAS,CAACG,QAAQ,CAAC,YAAY,CAAC;MAEhC,IAAIC,OAAO,GAAG,KAAK;MACnB,SAASC,GAAGA,CAACC,IAAI,EAAErB,KAAK,EAAE;QACxB,IAAIA,KAAK,KAAKE,SAAS,EAAE;UACvBa,SAAS,CAACO,YAAY,CAACD,IAAI,EAAErB,KAAK,CAAC;UACnCmB,OAAO,GAAG,IAAI;QAChB;MACF;MACAC,GAAG,CAAC,QAAQ,EAAEtB,UAAU,CAACC,OAAO,CAACiB,KAAK,CAACO,MAAM,EAAE,IAAI,CAAC,GAAGrB,SAAS,GAAG,GAAG,CAAC;MACvEkB,GAAG,CAAC,QAAQ,EAAEtB,UAAU,CAACC,OAAO,CAACiB,KAAK,CAACQ,MAAM,EAAE,KAAK,CAAC,GAAG,GAAG,GAAGtB,SAAS,CAAC;MAExEa,SAAS,CAACU,SAAS,CAAC,CAAC;MAErB,IAAIN,OAAO,EAAE;QACXJ,SAAS,CAACW,MAAM,CAAC,CAAC;MACpB,CAAC,MAAM;QACLX,SAAS,CAACY,QAAQ,CAAC,CAAC;MACtB;IACF;EAAC;IAAAf,GAAA;IAAAZ,KAAA,EAED,SAAA4B,UAAUC,IAAI,EAAE;MACd,IAAMb,KAAK,GAAG;QACZO,MAAM,EAAE,EAAEM,IAAI,CAACC,UAAU,CAACP,MAAM,KAAK,GAAG,CAAC;QACzCC,MAAM,EAAEK,IAAI,CAACC,UAAU,CAACN,MAAM,KAAK;MACrC,CAAC;;MAED;MACA,IAAMO,aAAa,GAAG,CAACf,KAAK,CAACO,MAAM,IAAIP,KAAK,CAACQ,MAAM;MAEnD,IAAI,CAACR,KAAK,GAAGe,aAAa,GAAGf,KAAK,GAAG,IAAI;IAC3C;EAAC;IAAAJ,GAAA;IAAAZ,KAAA,EAED,SAAAgC,UAAA,EAAY,CAAC;EAAC;IAAApB,GAAA;IAAAZ,KAAA,EAEd,SAAAiC,WAAA,EAAa;MACX,OAAO,KAAK;IACd;EAAC;EAAA,OAAA9B,eAAA;AAAA,EA5C2BP,SAAS;AA+CvCsC,MAAM,CAACC,OAAO,GAAGhC,eAAe"}