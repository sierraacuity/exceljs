{"version":3,"file":"workbook-writer.js","names":["_regeneratorRuntime","exports","Op","Object","prototype","hasOwn","hasOwnProperty","defineProperty","obj","key","desc","value","$Symbol","Symbol","iteratorSymbol","iterator","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","toStringTag","define","enumerable","configurable","writable","err","wrap","innerFn","outerFn","self","tryLocsList","protoGenerator","Generator","generator","create","context","Context","makeInvokeMethod","tryCatch","fn","arg","type","call","ContinueSentinel","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","getProto","getPrototypeOf","NativeIteratorPrototype","values","Gp","defineIteratorMethods","forEach","method","_invoke","AsyncIterator","PromiseImpl","invoke","resolve","reject","record","result","_typeof","__await","then","unwrapped","error","previousPromise","callInvokeWithMethodAndArg","state","Error","doneResult","delegate","delegateResult","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","done","methodName","undefined","return","TypeError","info","resultName","next","nextLoc","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","push","resetTryEntry","completion","reset","iterable","iteratorMethod","isNaN","length","i","displayName","isGeneratorFunction","genFun","ctor","constructor","name","mark","setPrototypeOf","__proto__","awrap","async","Promise","iter","keys","val","object","reverse","pop","skipTempReset","prev","charAt","slice","stop","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","finish","catch","_catch","thrown","delegateYield","asyncGeneratorStep","gen","_next","_throw","_asyncToGenerator","args","arguments","apply","_classCallCheck","instance","Constructor","_defineProperties","target","props","descriptor","_toPropertyKey","_createClass","protoProps","staticProps","_toPrimitive","String","input","hint","prim","toPrimitive","res","Number","fs","require","Archiver","StreamBuf","RelType","StylesXform","SharedStrings","DefinedNames","CoreXform","RelationshipsXform","ContentTypesXform","AppXform","WorkbookXform","SharedStringsXform","WorksheetWriter","theme1Xml","WorkbookWriter","options","created","Date","modified","creator","lastModifiedBy","lastPrinted","useSharedStrings","sharedStrings","styles","useStyles","Mock","_definedNames","_worksheets","views","zipOptions","zip","media","commentRefs","stream","filename","createWriteStream","pipe","promise","all","addThemes","addOfficeRels","get","_openStream","path","bufSize","batch","append","on","emit","_commitWorksheets","commitWorksheet","worksheet","committed","commit","promises","map","_commit","_callee","_callee$","_context","addMedia","addContentTypes","addApp","addCore","addSharedStrings","addStyles","addWorkbookRels","addWorkbook","_finalize","addImage","image","id","medium","assign","concat","extension","getImage","addWorksheet","tabColor","console","trace","properties","nextId","workbook","pageSetup","autoFilter","headerFooter","getWorksheet","find","_this","xml","_this2","_this3","xform","toXml","Id","Type","OfficeDocument","Target","CoreProperties","ExtenderProperties","_this4","model","worksheets","filter","Boolean","_this5","file","buffer","base64","dataimg64","content","substring","indexOf","_this6","_this7","coreXform","_this8","count","sharedStringsXform","_this9","relationships","Styles","Theme","rId","Worksheet","definedNames","calcProperties","prepare","_this10","finalize","module"],"sources":["../../../../lib/stream/xlsx/workbook-writer.js"],"sourcesContent":["const fs = require('fs');\r\nconst Archiver = require('archiver');\r\n\r\nconst StreamBuf = require('../../utils/stream-buf');\r\n\r\nconst RelType = require('../../xlsx/rel-type');\r\nconst StylesXform = require('../../xlsx/xform/style/styles-xform');\r\nconst SharedStrings = require('../../utils/shared-strings');\r\nconst DefinedNames = require('../../doc/defined-names');\r\n\r\nconst CoreXform = require('../../xlsx/xform/core/core-xform');\r\nconst RelationshipsXform = require('../../xlsx/xform/core/relationships-xform');\r\nconst ContentTypesXform = require('../../xlsx/xform/core/content-types-xform');\r\nconst AppXform = require('../../xlsx/xform/core/app-xform');\r\nconst WorkbookXform = require('../../xlsx/xform/book/workbook-xform');\r\nconst SharedStringsXform = require('../../xlsx/xform/strings/shared-strings-xform');\r\n\r\nconst WorksheetWriter = require('./worksheet-writer');\r\n\r\nconst theme1Xml = require('../../xlsx/xml/theme1.js');\r\n\r\nclass WorkbookWriter {\r\n  constructor(options) {\r\n    options = options || {};\r\n\r\n    this.created = options.created || new Date();\r\n    this.modified = options.modified || this.created;\r\n    this.creator = options.creator || 'ExcelJS';\r\n    this.lastModifiedBy = options.lastModifiedBy || 'ExcelJS';\r\n    this.lastPrinted = options.lastPrinted;\r\n\r\n    // using shared strings creates a smaller xlsx file but may use more memory\r\n    this.useSharedStrings = options.useSharedStrings || false;\r\n    this.sharedStrings = new SharedStrings();\r\n\r\n    // style manager\r\n    this.styles = options.useStyles ? new StylesXform(true) : new StylesXform.Mock(true);\r\n\r\n    // defined names\r\n    this._definedNames = new DefinedNames();\r\n\r\n    this._worksheets = [];\r\n    this.views = [];\r\n\r\n    this.zipOptions = options.zip;\r\n\r\n    this.media = [];\r\n    this.commentRefs = [];\r\n\r\n    this.zip = Archiver('zip', this.zipOptions);\r\n    if (options.stream) {\r\n      this.stream = options.stream;\r\n    } else if (options.filename) {\r\n      this.stream = fs.createWriteStream(options.filename);\r\n    } else {\r\n      this.stream = new StreamBuf();\r\n    }\r\n    this.zip.pipe(this.stream);\r\n\r\n    // these bits can be added right now\r\n    this.promise = Promise.all([this.addThemes(), this.addOfficeRels()]);\r\n  }\r\n\r\n  get definedNames() {\r\n    return this._definedNames;\r\n  }\r\n\r\n  _openStream(path) {\r\n    const stream = new StreamBuf({bufSize: 65536, batch: true});\r\n    this.zip.append(stream, {name: path});\r\n    stream.on('finish', () => {\r\n      stream.emit('zipped');\r\n    });\r\n    return stream;\r\n  }\r\n\r\n  _commitWorksheets() {\r\n    const commitWorksheet = function(worksheet) {\r\n      if (!worksheet.committed) {\r\n        return new Promise(resolve => {\r\n          worksheet.stream.on('zipped', () => {\r\n            resolve();\r\n          });\r\n          worksheet.commit();\r\n        });\r\n      }\r\n      return Promise.resolve();\r\n    };\r\n    // if there are any uncommitted worksheets, commit them now and wait\r\n    const promises = this._worksheets.map(commitWorksheet);\r\n    if (promises.length) {\r\n      return Promise.all(promises);\r\n    }\r\n    return Promise.resolve();\r\n  }\r\n\r\n  async commit() {\r\n    // commit all worksheets, then add suplimentary files\r\n    await this.promise;\r\n    await this.addMedia();\r\n    await this._commitWorksheets();\r\n    await Promise.all([\r\n      this.addContentTypes(),\r\n      this.addApp(),\r\n      this.addCore(),\r\n      this.addSharedStrings(),\r\n      this.addStyles(),\r\n      this.addWorkbookRels(),\r\n    ]);\r\n    await this.addWorkbook();\r\n    return this._finalize();\r\n  }\r\n\r\n  get nextId() {\r\n    // find the next unique spot to add worksheet\r\n    let i;\r\n    for (i = 1; i < this._worksheets.length; i++) {\r\n      if (!this._worksheets[i]) {\r\n        return i;\r\n      }\r\n    }\r\n    return this._worksheets.length || 1;\r\n  }\r\n\r\n  addImage(image) {\r\n    const id = this.media.length;\r\n    const medium = Object.assign({}, image, {type: 'image', name: `image${id}.${image.extension}`});\r\n    this.media.push(medium);\r\n    return id;\r\n  }\r\n\r\n  getImage(id) {\r\n    return this.media[id];\r\n  }\r\n\r\n  addWorksheet(name, options) {\r\n    // it's possible to add a worksheet with different than default\r\n    // shared string handling\r\n    // in fact, it's even possible to switch it mid-sheet\r\n    options = options || {};\r\n    const useSharedStrings =\r\n      options.useSharedStrings !== undefined ? options.useSharedStrings : this.useSharedStrings;\r\n\r\n    if (options.tabColor) {\r\n      // eslint-disable-next-line no-console\r\n      console.trace('tabColor option has moved to { properties: tabColor: {...} }');\r\n      options.properties = Object.assign(\r\n        {\r\n          tabColor: options.tabColor,\r\n        },\r\n        options.properties\r\n      );\r\n    }\r\n\r\n    const id = this.nextId;\r\n    name = name || `sheet${id}`;\r\n\r\n    const worksheet = new WorksheetWriter({\r\n      id,\r\n      name,\r\n      workbook: this,\r\n      useSharedStrings,\r\n      properties: options.properties,\r\n      state: options.state,\r\n      pageSetup: options.pageSetup,\r\n      views: options.views,\r\n      autoFilter: options.autoFilter,\r\n      headerFooter: options.headerFooter,\r\n    });\r\n\r\n    this._worksheets[id] = worksheet;\r\n    return worksheet;\r\n  }\r\n\r\n  getWorksheet(id) {\r\n    if (id === undefined) {\r\n      return this._worksheets.find(() => true);\r\n    }\r\n    if (typeof id === 'number') {\r\n      return this._worksheets[id];\r\n    }\r\n    if (typeof id === 'string') {\r\n      return this._worksheets.find(worksheet => worksheet && worksheet.name === id);\r\n    }\r\n    return undefined;\r\n  }\r\n\r\n  addStyles() {\r\n    return new Promise(resolve => {\r\n      this.zip.append(this.styles.xml, {name: 'xl/styles.xml'});\r\n      resolve();\r\n    });\r\n  }\r\n\r\n  addThemes() {\r\n    return new Promise(resolve => {\r\n      this.zip.append(theme1Xml, {name: 'xl/theme/theme1.xml'});\r\n      resolve();\r\n    });\r\n  }\r\n\r\n  addOfficeRels() {\r\n    return new Promise(resolve => {\r\n      const xform = new RelationshipsXform();\r\n      const xml = xform.toXml([\r\n        {Id: 'rId1', Type: RelType.OfficeDocument, Target: 'xl/workbook.xml'},\r\n        {Id: 'rId2', Type: RelType.CoreProperties, Target: 'docProps/core.xml'},\r\n        {Id: 'rId3', Type: RelType.ExtenderProperties, Target: 'docProps/app.xml'},\r\n      ]);\r\n      this.zip.append(xml, {name: '/_rels/.rels'});\r\n      resolve();\r\n    });\r\n  }\r\n\r\n  addContentTypes() {\r\n    return new Promise(resolve => {\r\n      const model = {\r\n        worksheets: this._worksheets.filter(Boolean),\r\n        sharedStrings: this.sharedStrings,\r\n        commentRefs: this.commentRefs,\r\n        media: this.media,\r\n      };\r\n      const xform = new ContentTypesXform();\r\n      const xml = xform.toXml(model);\r\n      this.zip.append(xml, {name: '[Content_Types].xml'});\r\n      resolve();\r\n    });\r\n  }\r\n\r\n  addMedia() {\r\n    return Promise.all(\r\n      this.media.map(medium => {\r\n        if (medium.type === 'image') {\r\n          const filename = `xl/media/${medium.name}`;\r\n          if (medium.filename) {\r\n            return this.zip.file(medium.filename, {name: filename});\r\n          }\r\n          if (medium.buffer) {\r\n            return this.zip.append(medium.buffer, {name: filename});\r\n          }\r\n          if (medium.base64) {\r\n            const dataimg64 = medium.base64;\r\n            const content = dataimg64.substring(dataimg64.indexOf(',') + 1);\r\n            return this.zip.append(content, {name: filename, base64: true});\r\n          }\r\n        }\r\n        throw new Error('Unsupported media');\r\n      })\r\n    );\r\n  }\r\n\r\n  addApp() {\r\n    return new Promise(resolve => {\r\n      const model = {\r\n        worksheets: this._worksheets.filter(Boolean),\r\n      };\r\n      const xform = new AppXform();\r\n      const xml = xform.toXml(model);\r\n      this.zip.append(xml, {name: 'docProps/app.xml'});\r\n      resolve();\r\n    });\r\n  }\r\n\r\n  addCore() {\r\n    return new Promise(resolve => {\r\n      const coreXform = new CoreXform();\r\n      const xml = coreXform.toXml(this);\r\n      this.zip.append(xml, {name: 'docProps/core.xml'});\r\n      resolve();\r\n    });\r\n  }\r\n\r\n  addSharedStrings() {\r\n    if (this.sharedStrings.count) {\r\n      return new Promise(resolve => {\r\n        const sharedStringsXform = new SharedStringsXform();\r\n        const xml = sharedStringsXform.toXml(this.sharedStrings);\r\n        this.zip.append(xml, {name: '/xl/sharedStrings.xml'});\r\n        resolve();\r\n      });\r\n    }\r\n    return Promise.resolve();\r\n  }\r\n\r\n  addWorkbookRels() {\r\n    let count = 1;\r\n    const relationships = [\r\n      {Id: `rId${count++}`, Type: RelType.Styles, Target: 'styles.xml'},\r\n      {Id: `rId${count++}`, Type: RelType.Theme, Target: 'theme/theme1.xml'},\r\n    ];\r\n    if (this.sharedStrings.count) {\r\n      relationships.push({\r\n        Id: `rId${count++}`,\r\n        Type: RelType.SharedStrings,\r\n        Target: 'sharedStrings.xml',\r\n      });\r\n    }\r\n    this._worksheets.forEach(worksheet => {\r\n      if (worksheet) {\r\n        worksheet.rId = `rId${count++}`;\r\n        relationships.push({\r\n          Id: worksheet.rId,\r\n          Type: RelType.Worksheet,\r\n          Target: `worksheets/sheet${worksheet.id}.xml`,\r\n        });\r\n      }\r\n    });\r\n    return new Promise(resolve => {\r\n      const xform = new RelationshipsXform();\r\n      const xml = xform.toXml(relationships);\r\n      this.zip.append(xml, {name: '/xl/_rels/workbook.xml.rels'});\r\n      resolve();\r\n    });\r\n  }\r\n\r\n  addWorkbook() {\r\n    const {zip} = this;\r\n    const model = {\r\n      worksheets: this._worksheets.filter(Boolean),\r\n      definedNames: this._definedNames.model,\r\n      views: this.views,\r\n      properties: {},\r\n      calcProperties: {},\r\n    };\r\n\r\n    return new Promise(resolve => {\r\n      const xform = new WorkbookXform();\r\n      xform.prepare(model);\r\n      zip.append(xform.toXml(model), {name: '/xl/workbook.xml'});\r\n      resolve();\r\n    });\r\n  }\r\n\r\n  _finalize() {\r\n    return new Promise((resolve, reject) => {\r\n      this.stream.on('error', reject);\r\n      this.stream.on('finish', () => {\r\n        resolve(this);\r\n      });\r\n      this.zip.on('error', reject);\r\n\r\n      this.zip.finalize();\r\n    });\r\n  }\r\n}\r\n\r\nmodule.exports = WorkbookWriter;\r\n"],"mappings":"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"}