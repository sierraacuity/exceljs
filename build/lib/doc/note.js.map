{"version":3,"file":"note.js","names":["_","require","Note","note","_classCallCheck","_createClass","key","get","value","_typeof","type","texts","text","deepMerge","DEFAULT_CONFIGS","set","length","Object","keys","fromModel","model","margins","insetmode","inset","protection","locked","lockText","editAs","module","exports"],"sources":["../../../lib/doc/note.js"],"sourcesContent":["const _ = require('../utils/under-dash');\r\n\r\nclass Note {\r\n  constructor(note) {\r\n    this.note = note;\r\n  }\r\n\r\n  get model() {\r\n    let value = null;\r\n    switch (typeof this.note) {\r\n      case 'string':\r\n        value = {\r\n          type: 'note',\r\n          note: {\r\n            texts: [\r\n              {\r\n                text: this.note,\r\n              },\r\n            ],\r\n          },\r\n        };\r\n        break;\r\n      default:\r\n        value = {\r\n          type: 'note',\r\n          note: this.note,\r\n        };\r\n        break;\r\n    }\r\n    // Suitable for all cell comments\r\n    return _.deepMerge({}, Note.DEFAULT_CONFIGS, value);\r\n  }\r\n\r\n  set model(value) {\r\n    const {note} = value;\r\n    const {texts} = note;\r\n    if (texts.length === 1 && Object.keys(texts[0]).length === 1) {\r\n      this.note = texts[0].text;\r\n    } else {\r\n      this.note = note;\r\n    }\r\n  }\r\n\r\n  static fromModel(model) {\r\n    const note = new Note();\r\n    note.model = model;\r\n    return note;\r\n  }\r\n}\r\n\r\nNote.DEFAULT_CONFIGS = {\r\n  note: {\r\n    margins: {\r\n      insetmode: 'auto',\r\n      inset: [0.13, 0.13, 0.25, 0.25],\r\n    },\r\n    protection: {\r\n      locked: 'True',\r\n      lockText: 'True',\r\n    },\r\n    editAs: 'absolute',\r\n  },\r\n};\r\n\r\nmodule.exports = Note;\r\n"],"mappings":";;;;;;;;AAAA,IAAMA,CAAC,GAAGC,OAAO,CAAC,qBAAqB,CAAC;AAAC,IAEnCC,IAAI;EACR,SAAAA,KAAYC,IAAI,EAAE;IAAAC,eAAA,OAAAF,IAAA;IAChB,IAAI,CAACC,IAAI,GAAGA,IAAI;EAClB;EAACE,YAAA,CAAAH,IAAA;IAAAI,GAAA;IAAAC,GAAA,EAED,SAAAA,IAAA,EAAY;MACV,IAAIC,KAAK,GAAG,IAAI;MAChB,QAAAC,OAAA,CAAe,IAAI,CAACN,IAAI;QACtB,KAAK,QAAQ;UACXK,KAAK,GAAG;YACNE,IAAI,EAAE,MAAM;YACZP,IAAI,EAAE;cACJQ,KAAK,EAAE,CACL;gBACEC,IAAI,EAAE,IAAI,CAACT;cACb,CAAC;YAEL;UACF,CAAC;UACD;QACF;UACEK,KAAK,GAAG;YACNE,IAAI,EAAE,MAAM;YACZP,IAAI,EAAE,IAAI,CAACA;UACb,CAAC;UACD;MACJ;MACA;MACA,OAAOH,CAAC,CAACa,SAAS,CAAC,CAAC,CAAC,EAAEX,IAAI,CAACY,eAAe,EAAEN,KAAK,CAAC;IACrD,CAAC;IAAAO,GAAA,EAED,SAAAA,IAAUP,KAAK,EAAE;MACf,IAAOL,IAAI,GAAIK,KAAK,CAAbL,IAAI;MACX,IAAOQ,KAAK,GAAIR,IAAI,CAAbQ,KAAK;MACZ,IAAIA,KAAK,CAACK,MAAM,KAAK,CAAC,IAAIC,MAAM,CAACC,IAAI,CAACP,KAAK,CAAC,CAAC,CAAC,CAAC,CAACK,MAAM,KAAK,CAAC,EAAE;QAC5D,IAAI,CAACb,IAAI,GAAGQ,KAAK,CAAC,CAAC,CAAC,CAACC,IAAI;MAC3B,CAAC,MAAM;QACL,IAAI,CAACT,IAAI,GAAGA,IAAI;MAClB;IACF;EAAC;IAAAG,GAAA;IAAAE,KAAA,EAED,SAAAW,UAAiBC,KAAK,EAAE;MACtB,IAAMjB,IAAI,GAAG,IAAID,IAAI,CAAC,CAAC;MACvBC,IAAI,CAACiB,KAAK,GAAGA,KAAK;MAClB,OAAOjB,IAAI;IACb;EAAC;EAAA,OAAAD,IAAA;AAAA;AAGHA,IAAI,CAACY,eAAe,GAAG;EACrBX,IAAI,EAAE;IACJkB,OAAO,EAAE;MACPC,SAAS,EAAE,MAAM;MACjBC,KAAK,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI;IAChC,CAAC;IACDC,UAAU,EAAE;MACVC,MAAM,EAAE,MAAM;MACdC,QAAQ,EAAE;IACZ,CAAC;IACDC,MAAM,EAAE;EACV;AACF,CAAC;AAEDC,MAAM,CAACC,OAAO,GAAG3B,IAAI"}