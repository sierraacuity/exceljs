{"version":3,"file":"workbook.js","names":["_typeof","obj","Symbol","iterator","constructor","prototype","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","_toPropertyKey","key","_createClass","protoProps","staticProps","arg","_toPrimitive","String","input","hint","prim","toPrimitive","undefined","res","call","Number","Worksheet","require","DefinedNames","XLSX","CSV","Workbook","category","company","created","Date","description","keywords","manager","modified","properties","calcProperties","_worksheets","subject","title","views","media","_definedNames","get","_xlsx","_csv","value","addWorksheet","name","options","id","nextId","console","trace","tabColor","argb","theme","indexed","lastOrderNo","reduce","acc","ws","orderNo","worksheetOptions","assign","workbook","worksheet","removeWorksheetEx","removeWorksheet","getWorksheet","destroy","find","Boolean","slice","sort","a","b","filter","eachSheet","iteratee","worksheets","forEach","sheet","clearThemes","_themes","addImage","image","push","type","getImage","creator","lastModifiedBy","lastPrinted","map","model","sheets","definedNames","language","revision","contentStatus","themes","set","_this","worksheetModel","state","findIndex","module","exports"],"sources":["../../../lib/doc/workbook.js"],"sourcesContent":["'use strict';\r\n\r\nconst Worksheet = require('./worksheet');\r\nconst DefinedNames = require('./defined-names');\r\nconst XLSX = require('../xlsx/xlsx');\r\nconst CSV = require('../csv/csv');\r\n\r\n// Workbook requirements\r\n//  Load and Save from file and stream\r\n//  Access/Add/Delete individual worksheets\r\n//  Manage String table, Hyperlink table, etc.\r\n//  Manage scaffolding for contained objects to write to/read from\r\n\r\nclass Workbook {\r\n  constructor() {\r\n    this.category = '';\r\n    this.company = '';\r\n    this.created = new Date();\r\n    this.description = '';\r\n    this.keywords = '';\r\n    this.manager = '';\r\n    this.modified = this.created;\r\n    this.properties = {};\r\n    this.calcProperties = {};\r\n    this._worksheets = [];\r\n    this.subject = '';\r\n    this.title = '';\r\n    this.views = [];\r\n    this.media = [];\r\n    this._definedNames = new DefinedNames();\r\n  }\r\n\r\n  get xlsx() {\r\n    if (!this._xlsx) this._xlsx = new XLSX(this);\r\n    return this._xlsx;\r\n  }\r\n\r\n  get csv() {\r\n    if (!this._csv) this._csv = new CSV(this);\r\n    return this._csv;\r\n  }\r\n\r\n  get nextId() {\r\n    // find the next unique spot to add worksheet\r\n    for (let i = 1; i < this._worksheets.length; i++) {\r\n      if (!this._worksheets[i]) {\r\n        return i;\r\n      }\r\n    }\r\n    return this._worksheets.length || 1;\r\n  }\r\n\r\n  addWorksheet(name, options) {\r\n    const id = this.nextId;\r\n\r\n    // if options is a color, call it tabColor (and signal deprecated message)\r\n    if (options) {\r\n      if (typeof options === 'string') {\r\n        // eslint-disable-next-line no-console\r\n        console.trace(\r\n          'tabColor argument is now deprecated. Please use workbook.addWorksheet(name, {properties: { tabColor: { argb: \"rbg value\" } }'\r\n        );\r\n        options = {\r\n          properties: {\r\n            tabColor: {argb: options},\r\n          },\r\n        };\r\n      } else if (options.argb || options.theme || options.indexed) {\r\n        // eslint-disable-next-line no-console\r\n        console.trace(\r\n          'tabColor argument is now deprecated. Please use workbook.addWorksheet(name, {properties: { tabColor: { ... } }'\r\n        );\r\n        options = {\r\n          properties: {\r\n            tabColor: options,\r\n          },\r\n        };\r\n      }\r\n    }\r\n\r\n    const lastOrderNo = this._worksheets.reduce((acc, ws) => ((ws && ws.orderNo) > acc ? ws.orderNo : acc), 0);\r\n    const worksheetOptions = Object.assign({}, options, {\r\n      id,\r\n      name,\r\n      orderNo: lastOrderNo + 1,\r\n      workbook: this,\r\n    });\r\n\r\n    const worksheet = new Worksheet(worksheetOptions);\r\n\r\n    this._worksheets[id] = worksheet;\r\n    return worksheet;\r\n  }\r\n\r\n  removeWorksheetEx(worksheet) {\r\n    delete this._worksheets[worksheet.id];\r\n  }\r\n\r\n  removeWorksheet(id) {\r\n    const worksheet = this.getWorksheet(id);\r\n    if (worksheet) {\r\n      worksheet.destroy();\r\n    }\r\n  }\r\n\r\n  getWorksheet(id) {\r\n    if (id === undefined) {\r\n      return this._worksheets.find(Boolean);\r\n    }\r\n    if (typeof id === 'number') {\r\n      return this._worksheets[id];\r\n    }\r\n    if (typeof id === 'string') {\r\n      return this._worksheets.find(worksheet => worksheet && worksheet.name === id);\r\n    }\r\n    return undefined;\r\n  }\r\n\r\n  get worksheets() {\r\n    // return a clone of _worksheets\r\n    return this._worksheets\r\n      .slice(1)\r\n      .sort((a, b) => a.orderNo - b.orderNo)\r\n      .filter(Boolean);\r\n  }\r\n\r\n  eachSheet(iteratee) {\r\n    this.worksheets.forEach(sheet => {\r\n      iteratee(sheet, sheet.id);\r\n    });\r\n  }\r\n\r\n  get definedNames() {\r\n    return this._definedNames;\r\n  }\r\n\r\n  clearThemes() {\r\n    // Note: themes are not an exposed feature, meddle at your peril!\r\n    this._themes = undefined;\r\n  }\r\n\r\n  addImage(image) {\r\n    // TODO:  validation?\r\n    const id = this.media.length;\r\n    this.media.push(Object.assign({}, image, {type: 'image'}));\r\n    return id;\r\n  }\r\n\r\n  getImage(id) {\r\n    return this.media[id];\r\n  }\r\n\r\n  get model() {\r\n    return {\r\n      creator: this.creator || 'Unknown',\r\n      lastModifiedBy: this.lastModifiedBy || 'Unknown',\r\n      lastPrinted: this.lastPrinted,\r\n      created: this.created,\r\n      modified: this.modified,\r\n      properties: this.properties,\r\n      worksheets: this.worksheets.map(worksheet => worksheet.model),\r\n      sheets: this.worksheets.map(ws => ws.model).filter(Boolean),\r\n      definedNames: this._definedNames.model,\r\n      views: this.views,\r\n      company: this.company,\r\n      manager: this.manager,\r\n      title: this.title,\r\n      subject: this.subject,\r\n      keywords: this.keywords,\r\n      category: this.category,\r\n      description: this.description,\r\n      language: this.language,\r\n      revision: this.revision,\r\n      contentStatus: this.contentStatus,\r\n      themes: this._themes,\r\n      media: this.media,\r\n      calcProperties: this.calcProperties,\r\n    };\r\n  }\r\n\r\n  set model(value) {\r\n    this.creator = value.creator;\r\n    this.lastModifiedBy = value.lastModifiedBy;\r\n    this.lastPrinted = value.lastPrinted;\r\n    this.created = value.created;\r\n    this.modified = value.modified;\r\n    this.company = value.company;\r\n    this.manager = value.manager;\r\n    this.title = value.title;\r\n    this.subject = value.subject;\r\n    this.keywords = value.keywords;\r\n    this.category = value.category;\r\n    this.description = value.description;\r\n    this.language = value.language;\r\n    this.revision = value.revision;\r\n    this.contentStatus = value.contentStatus;\r\n\r\n    this.properties = value.properties;\r\n    this.calcProperties = value.calcProperties;\r\n    this._worksheets = [];\r\n    value.worksheets.forEach(worksheetModel => {\r\n      const {id, name, state} = worksheetModel;\r\n      const orderNo = value.sheets && value.sheets.findIndex(ws => ws.id === id);\r\n      const worksheet = (this._worksheets[id] = new Worksheet({\r\n        id,\r\n        name,\r\n        orderNo,\r\n        state,\r\n        workbook: this,\r\n      }));\r\n      worksheet.model = worksheetModel;\r\n    });\r\n\r\n    this._definedNames.model = value.definedNames;\r\n    this.views = value.views;\r\n    this._themes = value.themes;\r\n    this.media = value.media || [];\r\n  }\r\n}\r\n\r\nmodule.exports = Workbook;\r\n"],"mappings":"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"}